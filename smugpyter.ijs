NB. JOD dictionary dump:  1 Dec 2018 19:20:57
NB. Generated with JOD version; 0.9.998 - dev; 1; 27 Oct 2018 15:26:08
NB. J version: j807/j64/windows/release/commercial/www.jsoftware.com/2018-10-05T10:39:42
NB.
NB. Names & DidNums on current path
NB. +---------+---------------------------------------+
NB. |smugpyter|222940491384479426302418047456064767038|
NB. +---------+---------------------------------------+

9!:41 [ 1 NB.{*JOD*}
cocurrent 'base' NB.{*JOD*}
sonl_z_=: 'sonl__MK__JODobj i.4' NB.{*JOD*}
showpass_z_=:] [ 1!:2&2 NB.{*JOD*}
SOLOCALE_z_=:":>SO__JODobj NB.{*JOD*}
soput_z_=:SOLOCALE&put NB.{*JOD*}
soclear_z_=: '0 0 $ clearso__MK__JODobj 0' NB.{*JOD*}

cocurrent SO__JODobj NB.{*JOD*}


AlbumXref=:,:<;._1 ' albumid mirpathid albumsize albumname'

CSS_Colors=:141 3$'ColorName';'HexValue';'RGBValue';'aliceblue';'#F0F8FF';240 248 255;'antiquewhite';'#FAEBD7';250 235 215;'aqua';'#00FFFF';0 255 255;'aquamarine';'#7FFFD4';127 255 212;'azure';'#F0FFFF';240 255 255;'beige';'#F5F5DC';245 245 220;'bisque';'#FFE4C4';255 228 196;'black';'#000000';0 0 0;'blanchedalmond';'#FFEBCD';255 235 205;'blue';'#0000FF';0 0 255;'blueviolet';'#8A2BE2';138 43 226;'brown';'#A52A2A';165 42 42;'burlywood';'#DEB887';222 184 135;'cadetblue';'#5F9EA0';95 158 160;'chartreuse';'#7FFF00';127 255 0;'chocolate';'#D2691E';210 105 30;'coral';'#FF7F50';255 127 80;'cornflowerblue';'#6495ED';100 149 237;'cornsilk';'#FFF8DC';255 248 220;'crimson';'#DC143C';220 20 60;'cyan';'#00FFFF';0 255 255;'darkblue';'#00008B';0 0 139;'darkcyan';'#008B8B';0 139 139;'darkgoldenrod';'#B8860B';184 134 11;'darkgray';'#A9A9A9';169 169 169;'darkgreen';'#006400';0 100 0;'darkkhaki';'#BDB76B';189 183 107;'darkmagenta';'#8B008B';139 0 139;'darkolivegreen';'#556B2F';85 107 47;'darkorange';'#FF8C00';255 140 0;'darkorchid';'#9932CC';153 50 204;'darkred';'#8B0000';139 0 0;'darksalmon';'#E9967A';233 150 122;'darkseagreen';'#8FBC8F';143 188 143;'darkslateblue';'#483D8B';72 61 139;'darkslategray';'#2F4F4F';47 79 79;'darkturquoise';'#00CED1';0 206 209;'darkviolet';'#9400D3';148 0 211;'deeppink';'#FF1493';255 20 147;'deepskyblue';'#00BFFF';0 191 255;'dimgray';'#696969';105 105 105;'dodgerblue';'#1E90FF';30 144 255;'firebrick';'#B22222';178 34 34;'floralwhite';'#FFFAF0';255 250 240;'forestgreen';'#228B22';34 139 34;'fuchsia';'#FF00FF';255 0 255;'gainsboro';'#DCDCDC';220 220 220;'ghostwhite';'#F8F8FF';248 248 255;'gold';'#FFD700';255 215 0;'goldenrod';'#DAA520';218 165 32;'gray';'#808080';128 128 128;'green';'#008000';0 128 0;'greenyellow';'#ADFF2F';173 255 47;'honeydew';'#F0FFF0';240 255 240;'hotpink';'#FF69B4';255 105 180;'indianred';'#CD5C5C';205 92 92;'indigo';'#4B0082';75 0 130;'ivory';'#FFFFF0';255 255 240;'khaki';'#F0E68C';240 230 140;'lavender';'#E6E6FA';230 230 250;'lavenderblush';'#FFF0F5';255 240 245;'lawngreen';'#7CFC00';124 252 0;'lemonchiffon';'#FFFACD';255 250 205;'lightblue';'#ADD8E6';173 216 230;'lightcoral';'#F08080';240 128 128;'lightcyan';'#E0FFFF';224 255 255;'lightgoldenrodyellow';'#FAFAD2';250 250 210;'lightgreen';'#90EE90';144 238 144;'lightgrey';'#D3D3D3';211 211 211;'lightpink';'#FFB6C1';255 182 193;'lightsalmon';'#FFA07A';255 160 122;'lightseagreen';'#20B2AA';32 178 170;'lightskyblue';'#87CEFA';135 206 250;'lightslategray';'#778899';119 136 153;'lightsteelblue';'#B0C4DE';176 196 222;'lightyellow';'#FFFFE0';255 255 224;'lime';'#00FF00';0 255 0;'limegreen';'#32CD32';50 205 50;'linen';'#FAF0E6';250 240 230;'magenta';'#FF00FF';255 0 255;'maroon';'#800000';128 0 0;'mediumaquamarine';'#66CDAA';102 205 170;'mediumblue';'#0000CD';0 0 205;'mediumorchid';'#BA55D3';186 85 211;'mediumpurple';'#9370DB';147 112 219;'mediumseagreen';'#3CB371';60 179 113;'mediumslateblue';'#7B68EE';123 104 238;'mediumspringgreen';'#00FA9A';0 250 154;'mediumturquoise';'#48D1CC';72 209 204;'mediumvioletred';'#C71585';199 21 133;'midnightblue';'#191970';25 25 112;'mintcream';'#F5FFFA';245 255 250;'mistyrose';'#FFE4E1';255 228 225;'moccasin';'#FFE4B5';255 228 181;'navajowhite';'#FFDEAD';255 222 173;'navy';'#000080';0 0 128;'oldlace';'#FDF5E6';253 245 230;'olive';'#808000';128 128 0;'olivedrab';'#6B8E23';107 142 35;'orange';'#FFA500';255 165 0;'orangered';'#FF4500';255 69 0;'orchid';'#DA70D6';218 112 214;'palegoldenrod';'#EEE8AA';238 232 170;'palegreen';'#98FB98';152 251 152;'paleturquoise';'#AFEEEE';175 238 238;'palevioletred';'#DB7093';219 112 147;'papayawhip';'#FFEFD5';255 239 213;'peachpuff';'#FFDAB9';255 218 185;'peru';'#CD853F';205 133 63;'pink';'#FFC0CB';255 192 203;'plum';'#DDA0DD';221 160 221;'powderblue';'#B0E0E6';176 224 230;'purple';'#800080';128 0 128;'red';'#FF0000';255 0 0;'rosybrown';'#BC8F8F';188 143 143;'royalblue';'#4169E1';65 105 225;'saddlebrown';'#8B4513';139 69 19;'salmon';'#FA8072';250 128 114;'sandybrown';'#F4A460';244 164 96;'seagreen';'#2E8B57';46 139 87;'seashell';'#FFF5EE';255 245 238;'sienna';'#A0522D';160 82 45;'silver';'#C0C0C0';192 192 192;'skyblue';'#87CEEB';135 206 235;'slateblue';'#6A5ACD';106 90 205;'slategray';'#708090';112 128 144;'snow';'#FFFAFA';255 250 250;'springgreen';'#00FF7F';0 255 127;'steelblue';'#4682B4';70 130 180;'tan';'#D2B48C';210 180 140;'teal';'#008080';0 128 128;'thistle';'#D8BFD8';216 191 216;'tomato';'#FF6347';255 99 71;'turquoise';'#40E0D0';64 224 208;'violet';'#EE82EE';238 130 238;'wheat';'#F5DEB3';245 222 179;'white';'#FFFFFF';255 255 255;'whitesmoke';'#F5F5F5';245 245 245;'yellow';'#FFFF00';255 255 0;'yellowgreen';'#9ACD32';154 205 50

CreateMirror_sql=:'sql code reference - see (MirrorXref) group header'

DEBRIIBAT=:'c:/temp/debrii.bat'

DEBRIIEXT=:<;._1 ' browseinfo tif_original'

DominantColorPfx=:'0_'

ExtXref=:13 3$<;._1 '|ext|extlong|extdesc|apf|afphoto|affinity photo layer file|psd||photoshop layer file|jpg||jpeg file|tif||tagged image format file|png||portable network graphic file|pdf||portable document format file|gif||graphic image file|nef||nikon raw file|eps||encapsulated postscript|ps||postscript|jp2||jpeg 2000 file|dng||digital negative'

IFACEWORDSMirrorXref=:,<'BuildMirror'

LOCOMISS=:'locomiss.txt'

LOCOXREF=:'locoxref.txt'

LocalFile_sql=:'sql code reference - see (MirrorXref) header'

LocalOnlineFile_sql=:'sql code reference - see (MirrorXref) header'

MACROSMirrorXref=:,<'base36_py'

MANLOCOXREF=:'manlocoxref.txt'

MIRRORDB=:'mirror.db'

MIRRORHEAD=:'c:/'

MirrorXref=:,:<;._1 ' orgvolid orgpathid orgext orgimagehash mirvolid mirpathid mirext albumid mirimageid orgfile mirfile'

MissingLocalFiles_sql=:'REFERENCE: sql code reference - see (MirrorXref) header'

NOPIXELSKEY=:'0z0'

NORATIOKEY=:'0z1'

PathXref=:,:<;._1 ' pathid pathdesc pathtype path'

ROOTWORDSMirrorXref=:<;._1 ' BuildMirror CreateMirror_sql IFACEWORDSMirrorXref LocalFile_sql LocalOnlineFile_sql MACROSMirrorXref MissingLocalFiles_sql ROOTWORDSMirrorXref UpdateLocalPresent_sql'

SMUGAREAROUND=:0.5

SMUGASPECTROUND=:0.0050000000000000001

SMUGPRINTDPI=:360

SMUGPRINTSIZES=:<;._1 ' 3.5x5 4x5 4x5.3 4x6 4x8 5x5 5x6.7 5x7 5x10 5x30 7x10 8x8 8x10 8x10.6 8x12 8x16 8x20 8.5x11 9x12 10x10 10x13 10x15 10x16 10x20 10x30 11x14 11x16 11x28 12x12 12x18 12x20 12x24 12x30 16x20 16x24 18x24 20x20 20x24 20x30'

SMUGPYTERSIZES=:<;._1 ' 3.5x5 4x5 4x5.3 4x6 4x8 5x5 5x6.7 5x7 5x10 5x30 7x10 8x8 8x10 8x10.6 8x12 8x16 8x20 8.5x11 9x12 10x10 10x13 10x15 10x16 10x20 10x30 11x14 11x16 11x28 12x12 12x18 12x20 12x24 12x30 16x20 16x24 18x24 20x20 20x24 20x30'

SVG_Colors=:148 2$'ColorName';'RGBValue';'aliceblue';240 248 255;'antiquewhite';250 235 215;'aqua';0 255 255;'aquamarine';127 255 212;'azure';240 255 255;'beige';245 245 220;'bisque';255 228 196;'black';0 0 0;'blanchedalmond';255 235 205;'blue';0 0 255;'blueviolet';138 43 226;'brown';165 42 42;'burlywood';222 184 135;'cadetblue';95 158 160;'chartreuse';127 255 0;'chocolate';210 105 30;'coral';255 127 80;'cornflowerblue';100 149 237;'cornsilk';255 248 220;'crimson';220 20 60;'cyan';0 255 255;'darkblue';0 0 139;'darkcyan';0 139 139;'darkgoldenrod';184 134 11;'darkgray';169 169 169;'darkgreen';0 100 0;'darkgrey';169 169 169;'darkkhaki';189 183 107;'darkmagenta';139 0 139;'darkolivegreen';85 107 47;'darkorange';255 140 0;'darkorchid';153 50 204;'darkred';139 0 0;'darksalmon';233 150 122;'darkseagreen';143 188 143;'darkslateblue';72 61 139;'darkslategray';47 79 79;'darkslategrey';47 79 79;'darkturquoise';0 206 209;'darkviolet';148 0 211;'deeppink';255 20 147;'deepskyblue';0 191 255;'dimgray';105 105 105;'dimgrey';105 105 105;'dodgerblue';30 144 255;'firebrick';178 34 34;'floralwhite';255 250 240;'forestgreen';34 139 34;'fuchsia';255 0 255;'gainsboro';220 220 220;'ghostwhite';248 248 255;'gold';255 215 0;'goldenrod';218 165 32;'gray';128 128 128;'grey';128 128 128;'green';0 128 0;'greenyellow';173 255 47;'honeydew';240 255 240;'hotpink';255 105 180;'indianred';205 92 92;'indigo';75 0 130;'ivory';255 255 240;'khaki';240 230 140;'lavender';230 230 250;'lavenderblush';255 240 245;'lawngreen';124 252 0;'lemonchiffon';255 250 205;'lightblue';173 216 230;'lightcoral';240 128 128;'lightcyan';224 255 255;'lightgoldenrodyellow';250 250 210;'lightgray';211 211 211;'lightgreen';144 238 144;'lightgrey';211 211 211;'lightpink';255 182 193;'lightsalmon';255 160 122;'lightseagreen';32 178 170;'lightskyblue';135 206 250;'lightslategray';119 136 153;'lightslategrey';119 136 153;'lightsteelblue';176 196 222;'lightyellow';255 255 224;'lime';0 255 0;'limegreen';50 205 50;'linen';250 240 230;'magenta';255 0 255;'maroon';128 0 0;'mediumaquamarine';102 205 170;'mediumblue';0 0 205;'mediumorchid';186 85 211;'mediumpurple';147 112 219;'mediumseagreen';60 179 113;'mediumslateblue';123 104 238;'mediumspringgreen';0 250 154;'mediumturquoise';72 209 204;'mediumvioletred';199 21 133;'midnightblue';25 25 112;'mintcream';245 255 250;'mistyrose';255 228 225;'moccasin';255 228 181;'navajowhite';255 222 173;'navy';0 0 128;'oldlace';253 245 230;'olive';128 128 0;'olivedrab';107 142 35;'orange';255 165 0;'orangered';255 69 0;'orchid';218 112 214;'palegoldenrod';238 232 170;'palegreen';152 251 152;'paleturquoise';175 238 238;'palevioletred';219 112 147;'papayawhip';255 239 213;'peachpuff';255 218 185;'peru';205 133 63;'pink';255 192 203;'plum';221 160 221;'powderblue';176 224 230;'purple';128 0 128;'red';255 0 0;'rosybrown';188 143 143;'royalblue';65 105 225;'saddlebrown';139 69 19;'salmon';250 128 114;'sandybrown';244 164 96;'seagreen';46 139 87;'seashell';255 245 238;'sienna';160 82 45;'silver';192 192 192;'skyblue';135 206 235;'slateblue';106 90 205;'slategray';112 128 144;'slategrey';112 128 144;'snow';255 250 250;'springgreen';0 255 127;'steelblue';70 130 180;'tan';210 180 140;'teal';0 128 128;'thistle';216 191 216;'tomato';255 99 71;'turquoise';64 224 208;'violet';238 130 238;'wheat';245 222 179;'white';255 255 255;'whitesmoke';245 245 245;'yellow';255 255 0;'yellowgreen';154 205 50

UpdateLocalPresent_sql=:'update Album set LocalPresent = 1 where AlbumKey in '

VolumeXref=:3 3$<;._1 '|volid|volume|voldesc|0|c:\|c drive on local machine|1|d:\|usb drive(s) (usually mounts on d)'

WEB_PyColors=:148 2$<;._1 ' ColorName HexValue aliceblue #f0f8ff antiquewhite #faebd7 aqua #00ffff aquamarine #7fffd4 azure #f0ffff beige #f5f5dc bisque #ffe4c4 black #000000 blanchedalmond #ffebcd blue #0000ff blueviolet #8a2be2 brown #a52a2a burlywood #deb887 cadetblue #5f9ea0 chartreuse #7fff00 chocolate #d2691e coral #ff7f50 cornflowerblue #6495ed cornsilk #fff8dc crimson #dc143c cyan #00ffff darkblue #00008b darkcyan #008b8b darkgoldenrod #b8860b darkgray #a9a9a9 darkgrey #a9a9a9 darkgreen #006400 darkkhaki #bdb76b darkmagenta #8b008b darkolivegreen #556b2f darkorange #ff8c00 darkorchid #9932cc darkred #8b0000 darksalmon #e9967a darkseagreen #8fbc8f darkslateblue #483d8b darkslategray #2f4f4f darkslategrey #2f4f4f darkturquoise #00ced1 darkviolet #9400d3 deeppink #ff1493 deepskyblue #00bfff dimgray #696969 dimgrey #696969 dodgerblue #1e90ff firebrick #b22222 floralwhite #fffaf0 forestgreen #228b22 fuchsia #ff00ff gainsboro #dcdcdc ghostwhite #f8f8ff gold #ffd700 goldenrod #daa520 gray #808080 grey #808080 green #008000 greenyellow #adff2f honeydew #f0fff0 hotpink #ff69b4 indianred #cd5c5c indigo #4b0082 ivory #fffff0 khaki #f0e68c lavender #e6e6fa lavenderblush #fff0f5 lawngreen #7cfc00 lemonchiffon #fffacd lightblue #add8e6 lightcoral #f08080 lightcyan #e0ffff lightgoldenrodyellow #fafad2 lightgray #d3d3d3 lightgrey #d3d3d3 lightgreen #90ee90 lightpink #ffb6c1 lightsalmon #ffa07a lightseagreen #20b2aa lightskyblue #87cefa lightslategray #778899 lightslategrey #778899 lightsteelblue #b0c4de lightyellow #ffffe0 lime #00ff00 limegreen #32cd32 linen #faf0e6 magenta #ff00ff maroon #800000 mediumaquamarine #66cdaa mediumblue #0000cd mediumorchid #ba55d3 mediumpurple #9370db mediumseagreen #3cb371 mediumslateblue #7b68ee mediumspringgreen #00fa9a mediumturquoise #48d1cc mediumvioletred #c71585 midnightblue #191970 mintcream #f5fffa mistyrose #ffe4e1 moccasin #ffe4b5 navajowhite #ffdead navy #000080 oldlace #fdf5e6 olive #808000 olivedrab #6b8e23 orange #ffa500 orangered #ff4500 orchid #da70d6 palegoldenrod #eee8aa palegreen #98fb98 paleturquoise #afeeee palevioletred #db7093 papayawhip #ffefd5 peachpuff #ffdab9 peru #cd853f pink #ffc0cb plum #dda0dd powderblue #b0e0e6 purple #800080 red #ff0000 rosybrown #bc8f8f royalblue #4169e1 saddlebrown #8b4513 salmon #fa8072 sandybrown #f4a460 seagreen #2e8b57 seashell #fff5ee sienna #a0522d silver #c0c0c0 skyblue #87ceeb slateblue #6a5acd slategray #708090 slategrey #708090 snow #fffafa springgreen #00ff7f steelblue #4682b4 tan #d2b48c teal #008080 thistle #d8bfd8 tomato #ff6347 turquoise #40e0d0 violet #ee82ee wheat #f5deb3 white #ffffff whitesmoke #f5f5f5 yellow #ffff00 yellowgreen #9acd32'

imageSchema_sql=:'create table image ( ImageKey text, AlbumKey text, FileName text, ArchivedMD5 text, ArchivedSize integer, Latitude float, Longitude float, Altitude integer, OriginalHeight integer, OriginalWidth integer, UploadDate date, LastUpdated date, Uri text, ThumbnailUrl text, Keywords text, Caption text) '

printsizekey_basictestdata=:16 3$<;._1 ' ImageKey OriginalHeight OriginalWidth 4wqd5Hr 3021 2014 K7JKbs8 2036 3122 nFRxBh2 2665 3731 xCdD7V8 2585 1736 sTXnpLm 2192 3289 VG2s4WG 3659 2613 kNRs3X8 1694 2543 Qjs2hr6 3848 2559 qbXqVgC 2633 3949 ZdzNXm3 1162 2506 vF4Bwpg 2531 3542 7WbqpMj 3211 2566 2cCVDMK 1846 2398 36kBgrv 2396 1991 2FzVqjP 1887 2398'

showpass soput ".'nl_',SOLOCALE,'_ i.4' [ cocurrent 'base' NB.{*JOD*}
".soclear NB.{*JOD*}
cocurrent SO__JODobj NB.{*JOD*}


AlbumPathTable=:3 : 0

NB.*AlbumPathTable  v--  complete  local  path  table from  album
NB. parent folders.
NB.
NB. monad: bt =. AlbumPathTable clMirrorDB
NB.
NB.   AlbumPathTable 'c:/SmugMirror/Documents/XrefDb/mirror.db'
NB.
NB. dyad:  bt =. clPathPfx AlbumPathTable clMirrorDB
NB.
NB.   'root' AlbumPathTable 'c:/SmugMirror/Documents/XrefDb/mirror.db'

'c:/SmugMirror/Mirror' AlbumPathTable y
:
db=. sqlopen_psqlite_ y
d=. sqldict__db 'select  AlbumName, ParentFolders from Album'
sqlclose__db ''

NB. define columns !(*)=. AlbumName ParentFolders
(0 {"1 d)=. 1 {"1 d

NB. remove troublesome path characters
a=. AlbumName -.&.> <' -_'''
p=. ParentFolders -.&.> <' -_'

NB. path table
t=. (<;._1&.> '!parents'&beforestr @ ('/user'&afterstr) &.> p) ,&> <"0 a

NB. adjust prefix
(<x) 0}"1 t
)

BackUpMirrorXrefDb=:3 : 0

NB.*BackUpMirrorXrefDb v-- backup  mirror  database and erase  if
NB. (x) is 1.
NB.
NB. monad:  iaRc =. BackUpMirrorXrefDb (clMirrorDir ; clBackupDir)
NB.
NB.   mrd=. 'c:/smugmirror/documents/xrefdb/'         NB. mirror ddirectory  
NB.   bak=. 'c:/smugmirror/documents/xrefdb/backup/'  NB. mirror backup directory
NB.   BackUpMirrorXrefDb mrd;bak
NB.
NB. dyad:  iaRc =. paClearDb BackUpMirrorXrefDb (clMirrorDir ; clBackupDir)

1 BackUpMirrorXrefDb y
:
'source target'=. tslash2&.> y
'tdate ttime'=. yyyymondd 0
bakpfx=. target,tdate,'-00-'

rc=. 0  NB. assume failure
try.

  if. -.fexist source,MIRRORDB do.
    1 [ smoutput MIRRORDB,' database missing - continue build' return.
  end.

  if. x -: 1 do.

    NB. read (MIRRORDB) bytes - this copy method
    NB. works well for files < 200MB and (MIRRORDB)
    NB. will remain well below that threshold.
    bindb=. read source,MIRRORDB
    txtxf=.''
    mantxtf=.''
    if. fexist source,LOCOXREF    do. txtxf=. read source,LOCOXREF end.
    if. fexist source,MANLOCOXREF do. mantxtf=. read source,MANLOCOXREF end.
    if. 1e6 > #bindb do.
      rc [ smoutput MIRRORDB,' to small' return.
    end.

    NB. get today's backup files !(*)=. dir
    if. #files=. \:~ 1 dir target,tdate,'*.db' do.
      NB. increment day backup - allow 100 per day
      bcnt=. _1&". _2 {. '-'&beforelaststr ;0{files
      if. (bcnt < 0) +. 100 <: bcnt do. 
        rc [ smoutput 'backup count invalid' return.
      end.
      bcnt=. ,'r<0>2.0' (8!:2) >:bcnt
      bakpfx=. target,tdate,'-',bcnt,'-'
    end.
  
    smoutput 'backing up -> ',bakpfx,MIRRORDB
    bindb write bakpfx,MIRRORDB
    txtxf write bakpfx,LOCOXREF
    mantxtf write bakpfx,MANLOCOXREF

    NB. clear db source if a backup exists
    if. fexist bakpfx,MIRRORDB do. 
      if. 0 > ferase source,MIRRORDB do.
        rc [ smoutput 'unable to erase ',MIRRORDB return.
      end.
    end.

  elseif. x -: 0 do.

    smoutput 'removing ',MIRRORDB,' without backup'
    if. 0 > ferase source,MIRRORDB do.
        rc [ smoutput 'unable to erase ',MIRRORDB return.
    end.

  elseif.do.

    rc [ smoutput 'invalid backup option' return.

  end.

  rc=. 1  NB. success
catch.
  rc=. 0
end.
rc
)

BuildMirror=:3 : 0

NB.*BuildMirror v-- backup/create/load mirror.db
NB.
NB. monad:  BuildMirror iaBackup
NB.
NB.   BuildMirror 0   NB. skip backup and build
NB.   BuildMirror 1   NB. backup and build

root=. 'c:/smugmirror/'

sdr=. root,'mirror'             NB. mirror directory
mrd=. root,'documents/xrefdb/'  NB. mirror database directory
trg=. mrd,MIRRORDB              NB. mirror db
bak=. mrd,'backup'              NB. mirror backup directory
dmp=. mrd,LOCOXREF              NB. online local pairs 
mcf=. mrd,MANLOCOXREF           NB. manual online local corrections
mli=. mrd,LOCOMISS              NB. missing local images report
src=. 'c:/thumbsdbs/primary2018.tpdb8s'  NB. thumbsplus db

if. y BackUpMirrorXrefDb mrd;bak do.
  smoutput LoadMirrorXrefDb sdr;src;trg;dmp;mcf;mli
else.
  smoutput 'no ',MIRRORDB,' build - backup issue(s)!'
end. 
)

CreateMirrorXrefDb=:3 : 0

NB.*CreateMirrorXrefDb v--  creates sqlite mirror cross reference
NB. database.
NB.
NB. monad:  blclTableNames = CreateMirrorXrefDb clMirrorDb
NB.
NB.   CreateMirrorXrefDb 'c:/SmugMirror/Documents/XrefDb/mirror.db'

('database exists -> ',y) assert -.fexist y

NB. parse schema sql - assumes ordered create statements delimited by ';'
sql=. reb&.> <;._1 ';', (LF,' ') charsub CreateMirror_sql -. CR

NB. create new empty database
dt=. sqlcreate_psqlite_ y

NB. create tables
for_create. sql do.
  create=. ;create
  ('unable to create table ->',create) assert 0 = sqlcmd__dt create
end.

tabs=. sqltables__dt ''
tabs [ sqlclose__dt ''
)

DumpLocalImageNatural=:3 : 0

NB.*DumpLocalImageNatural v--  dump (LocalImage) as TAB delimited
NB. text.
NB.
NB. (LocalImage) is the only table  in (mirror.db) that  contains
NB. information  that  cannot  be  recreated  from  TAB delimited
NB. SmugMirror text files  and ThumbsPlus databases. (LocalImage)
NB. matches online images to local images. Many can be matched by
NB. file name  but many  require  tedious  human  inspection. The
NB. mapping is not one-to-one some online images, like panoramas,
NB. are  derived   from  many  local  images.  This  verb   dumps
NB. (LocalImage) in the  form or TAB delimited  natural keys that
NB. preserves the online local pairing in durable version control
NB. friendly form.
NB.
NB. monad:  bl =. DumpLocalImageNatural (clDumpFile ; clMirrorDb)
NB. 
NB.   dmp=. 'c:/smugmirror/documents/xrefdb/locoxref.txt'
NB.   trg=. 'c:/smugmirror/documents/xrefdb/mirror.db'
NB.   DumpLocalImageNatural dmp;trg

'dmp trg'=. y
dt=. sqlopen_psqlite_ trg
oc=. sqlsize__dt 'OnlineImage'
ld=. sqldict__dt LocalOnlineFile_sql
rc=. sqlclose__dt ''

NB. box unboxed columns and format as char
hd=. 0 {"1 ld [ td=. 1 {"1 ld
pos=. I. 0 = L.&> td
td=. (":L:0(<"0)&.>pos{td) pos} td
td=. |: >td

NB. write as TAB delimited file
(hd,td) writetd2 dmp

NB. number of distinct local images
utd=. # ~. (hd i. <'ImageKey') {"1 td

NB. unique match percentage below should equal this result
NB. %/;(#&> > 1{sqlread__dt 'select distinct ImageKey from LocalImage');sqlsize__dt 'OnlineImage'

NB. record count; unique match percentage; file
(#td);(100 * utd%oc);dmp
)

LoadAlbum=:3 : 0

NB.*LoadAlbum v-- load (Album) table.
NB.
NB. (Album) references (LocalPath) execute (LoadLocalPath) before
NB. this verb.
NB.
NB. monad:  iaRc =. LoadAlbum (clMirrorDir ; clMirrorDb)
NB.
NB.   sdr=. 'c:/smugmirror/mirror'  NB. smugmug mirror directory
NB.   trg=. 'c:/smugmirror/documents/xrefdb/mirror.db'  NB. smugmug mirror
NB.   LoadAlbum sdr;trg

'sdr trg'=. y

NB. j profile !(*)=. dirtree
NB. all mirror directory albums contain an (ainfo-*.txt) file
ai=. 0 {"1 dirtree (tslash2 sdr),'ainfo-*.txt'

NB. standarize path format
pf=. tolower@('/'&beforelaststr)@('/'&afterstr)&.> ai

NB. fetch local path table
dt=.sqlopen_psqlite_ trg
dat=. sqldict__dt 'LocalPath'

NB. match ainfo paths with local path table
(0 {"1 dat)=. 1 {"1 dat

NB. table columns !(*)=. LocalPath LocalPathID
LocalPath=. tolower&.> LocalPath
'LocalPath(s) not found' assert (#LocalPath) > >./px=. LocalPath i. pf
LocalPathID=. px { LocalPathID

NB. read all TAB delimited ainfo files
hd=. 0{readtd2 0{ai
dat=. ,@}.@readtd2&> ai
'path id directory ainfo file mismatch' assert (#dat) = #LocalPathID

NB. check columns - ImageCount, Name, Description -->> OnlineImageCount, AlbumName, AlbumDescription
cx=. hd i. ;:'AlbumKey ImageCount LastUpdated ImagesLastUpdated Name ParentFolders WebUri Description'
'missing (AlbumKey, Name, LastUpdated, ImagesLastUpdated ParentFolders, WebUri, Description) column(s)' assert (#hd) > >./cx

NB. match local path ids to albums
dat=. <"1 |: 1 0 0 1 1 1 1 1 1 1 (#^:_1)"1 cx {"1 dat
dat=. (<LocalPathID) (1)} dat

NB. set all local sample images flag present to 0 - assume they are missing
dat=. (<0 #~ #LocalPathID) (2)} dat

NB. convert online image counts
dat=. (<_1&".&> ;3{dat) (3)} dat

NB. insert in Album table
cln=. ;:'AlbumKey LocalPathID LocalPresent OnlineImageCount LastUpdated ImagesLastUpdated AlbumName ParentFolders WebUri AlbumDescription'
rc=. sqlinsert__dt 'Album';cln;<dat
rc [ sqlclose__dt ''
)

LoadImageAlbumXr=:3 : 0

NB.*LoadImageAlbumXr v-- load (ImageAlbumXr) table.
NB.
NB. monad:  iaRc =. LoadImageAlbumXr (clDb ;< btclDat)

'trg dat'=. y
dt=. sqlopen_psqlite_ trg
rc=. dt insqltd 'ImageAlbumXr';<dat
rc [ sqlclose__dt ''
)

LoadImageKeywordXr=:3 : 0

NB.*LoadImageKeywordXr v-- load (ImageKeywordXr) table.
NB.
NB. monad:  iaRc =. LoadImageKeywordXr (clDb ; <blclDat)
NB.
NB.   sdr=. 'c:/smugmirror/mirror'                      NB. mirror directory
NB.   trg=. 'c:/smugmirror/documents/xrefdb/mirror.db'  NB. smugmug mirror
NB.   'img iax'=. MirrorImageXrTables sdr
NB.   LoadOnlineKeyword trg;<img


'trg dat'=. y
dat=. }.dat [ head=. 0{dat

'image keys'=. <"1 |: (head i. ;:'ImageKey Keywords') {"1 dat
keys=. <;._1&.> (';' ,&.> keys) -.&.> ' '
image=. (#&> keys) # image

NB. insert image keyword xref
dt=. sqlopen_psqlite_ trg
rc=. sqlinsert__dt 'ImageKeywordXr';(;:'ImageKey Keyword');<image;<;keys
rc [ sqlclose__dt ''
)

LoadLocalPath=:3 : 0

NB.*LoadLocalPath v-- load (LocalPath) table.
NB.
NB. (LoadLocalPath)  uses values  from a ThumbsPlus SQLite (Path)
NB. table. ThumbsPlus builds a complete table of unique paths and
NB. and  path  primary  keys.  All  the  paths  (mirror.db)  will
NB. reference will be in this table.
NB.
NB. monad:  iaRc =. LoadLocalPath (clThumbsDb ; clMirrorDb)
NB.
NB.   src=. 'c:/thumbsdbs/working2018.tpdb8s'           NB. thumbsplus
NB.   trg=. 'c:/smugmirror/documents/xrefdb/mirror.db'  NB. smugmug mirror
NB.   LoadLocalPath src;trg

'src trg'=. y

NB. fetch thumbsplus data
ds=. sqlopen_psqlite_ src
dat=. sqlreads__ds 'select idPath, name from Path'
rc=. sqlclose__ds ''

NB. convert path delimiters
paths=. allwhitetrim&.> <"1 '\/' charsub ;1{1{dat
ids=. , ;0{1{dat

NB. insert in LocalPath
dt=. sqlopen_psqlite_ trg
rc=. sqlinsert__dt 'LocalPath';(;:'LocalPathID LocalPath');<ids;<paths
rc [ sqlclose__dt ''
)

LoadMirrorXrefDb=:3 : 0

NB.*LoadMirrorXrefDb  v--  loads   new  mirror   cross  reference
NB. database.
NB.
NB. monad:  btNameCnts = LoadMirrorXrefDb (clMirrorDr ; clThumbsDb ; clMirrorDb)
NB.
NB.   sdr=. 'c:/smugmirror/mirror'                      NB. mirror directory
NB.   src=. 'c:/thumbsdbs/primary2018.tpdb8s'           NB. thumbsplus db
NB.   trg=. 'c:/smugmirror/documents/xrefdb/mirror.db'  NB. mirror db
NB.   dmp=. 'c:/smugmirror/documents/xrefdb/locoxref.txt'  NB. online local pairs
NB.   mcf=. 'c:/smugmirror/documents/xrefdb/manlocoxref.txt'  NB. missing local online corrections
NB.   mli=. 'c:/smugmirror/documents/xrefdb/locomiss.txt'  NB. missing local images report
NB.   LoadMirrorXrefDb sdr;src;trg;dmp;mcf;mli

'sdr src trg dmp mcf mli'=. y

smoutput 'Creating mirror.db ...'
tabs=. CreateMirrorXrefDb trg

smoutput 'Loading path and albums ...'
LoadLocalPath src;trg
LoadAlbum sdr;trg

smoutput'Loading keywords ...'
'img iax'=. MirrorImageXrTables sdr
kw=. }. ((0{img) i. <'Keywords') {"1 img
LoadOnlineKeyword trg;<kw

smoutput 'Loading Images and cross references ...'
LoadOnlineImage trg;<img
LoadImageAlbumXr trg;<iax
LoadImageKeywordXr trg;<img

smoutput 'Checking existence of downloaded images ...'
UpdateLocalPresent trg

smoutput 'Matching online and local files with same file names ...'
MatchOnlineLocal src;trg

smoutput 'Matching online and local files after [] bracket suffix removal ...'
MatchOnlineNoBrackets src;trg

smoutput 'Matching manual local online files corrections ...'
MatchManual mcf;src;trg

smoutput 'Dumping current online local image pairs as TAB delimited text ...'
smoutput DumpLocalImageNatural dmp;trg

smoutput 'Writing missing images report ...'
smoutput MissingImagesReport mli;trg

NB. row counts in loaded tables
db=. sqlopen_psqlite_ trg
cnts=. tabs ,: sqlsize__db&.> tabs
cnts [ sqlclose__db ''
)

LoadOnlineImage=:3 : 0

NB.*LoadOnlineImage v-- load (OnlineImage) table.
NB.
NB. monad:  iaRc =. LoadOnlineImage (clDb ;< btclDat)

'trg dat'=. y
dat=. <"1 |: }. dat [ head=. 0{dat

NB. convert numeric columns
pos=. head i. ;:'ArchivedSize Altitude OriginalHeight OriginalWidth'
dat=. ((SQLITE_NULL_INTEGER_psqlite_&".&>) L: 1 [ pos{dat) pos} dat
pos=. head i. ;:'Latitude Longitude'
dat=. ((SQLITE_NULL_FLOAT_psqlite_&".&>) L: 1 [ pos{dat) pos} dat

dt=. sqlopen_psqlite_ trg
rc=. sqlinsert__dt 'OnlineImage';head;<dat
rc [ sqlclose__dt ''
)

LoadOnlineKeyword=:3 : 0

NB.*LoadOnlineKeyword v-- load (OnlineKeyword) table.
NB.
NB. monad:  LoadOnlineKeyword (clDb ; <blclKeywords)
NB.
NB.   trg=. 'c:/smugmirror/documents/xrefdb/mirror.db'  NB. smugmug mirror
NB.   keys=. 'boo;hoo;foo' ; 'yoo;key;me'               NB. keyword lists
NB.   LoadOnlineKeyword trg;<keys

'trg keys'=. y

if. #keys=. <;._1 (;';' ,&.> keys) -. ' ' do.
  NB. insert unique keywords and frequencies
  'kw fq'=. ofreq s: keys
  dt=. sqlopen_psqlite_ trg
  rc=. sqlinsert__dt 'OnlineKeyword';(;:'Keyword KeyFrequency');<(5&s: kw);fq
  rc [ sqlclose__dt ''
else.
  0
end.
)

LocalFrOnline=:4 : 0

NB.*LocalFrOnline  v--  local  file  names from  online keys  and
NB. filenames.
NB.
NB. Local file names are  derived  from online names by prefixing
NB. the name with the image key, followed by a lower case base 36
NB. case mask, followed  by the online  file name. All blanks are
NB. replaced with hyphen '-' characters.
NB.
NB. dyad:  bclObj LocalFrOnline clAlbumKey
NB.
NB.   db=. sqlopen_psqlite_ 'c:/smugmirror/documents/xrefdb/mirror.db'
NB.   db LocalFrOnline 'BFs8q4'

NB. fetch album
'invalid (AlbumKey)' assert 0 < #y

NB. use of sqlparm sometimes leaves databases open
NB. dat=. sqlparm__x LocalFile_sql;SQLITE_TEXT_psqlite_;y
sql=. ('/?/''',y,'''') changestr LocalFile_sql
dat=. sqldict__x sql

nofiles=. 0$<''
if. 0 e. #&> 1 {"1 dat do. nofiles return. end.

NB. table columns !(*)=. ImageKey OnlineImageFile LocalPath
(0 {"1 dat)=. boxopen&.> 1 {"1 dat

if. #ImageKey do.
  pfx=. ImageKey ,&.> '-' ,&.> (b36casemask ImageKey) ,&.> '-'
  (<MIRRORHEAD) ,&.> LocalPath ,&.> '/' ,&.> pfx ,&.> ' -'&charsub&.> OnlineImageFile
else.
  nofiles
end.
)

MatchManual=:3 : 0

NB.*MatchManual  v--  insert  manual  online  local  image   pair
NB. corrections.
NB.
NB. This verb  reads  a TAB  delimited file  of manual online and
NB. local image pairings  and inserts valid pairs into the mirror
NB. cross  reference database. Manual  corrections are  necessary
NB. for online images  with  file  names  that do follow patterns
NB. handled by (MatchOnlineLocal) and (MatchOnlineNoBrackets).
NB.
NB. monad:  iaRc =. MatchManual (clFixFile ; clThumbsDb ; clMirrorDb)
NB.
NB.   src=. 'c:/thumbsdbs/primary2018.tpdb8s'
NB.   trg=. 'c:/smugmirror/documents/xrefdb/mirror.db'
NB.   fix=. 'c:/smugmirror/documents/xrefdb/manlocoxref.txt'
NB.   MatchManual fix;src;trg

'fix src trg'=. y
rc=. 0

NB. manual corrections
mc=. }. mc [ hd=. 0 { mc=. readtd2 fix
'lp lf of'=. hd i. ;:'LocalPath LocalImageFile OnlineImageFile'

NB. look up path IDs and online image keys
NB. (*)=. LocalPathID LocalPath OnlineImageFile ImageKey LocalThumbID
dt=. sqlopen_psqlite_ trg
du=. sqldict__dt 'LocalPath'
dv=. sqldict__dt 'OnlineImageFile,ImageKey from OnlineImage'
rc=. sqlclose__dt''

(0{"1 du)=. 1 {"1 du
'missing manual local path(s)' assert (#LocalPath) > pos=. LocalPath i. lp {"1 mc
lpid=. pos { LocalPathID

(0{"1 dv)=. 1 {"1 dv
'invalid manual online image(s)' assert (#OnlineImageFile) > pos=. OnlineImageFile i. of {"1 mc
olik=. pos { ImageKey

NB. look up thumbsplus image ID - used as LocalThumbID
ds=. sqlopen_psqlite_ src
du=. sqldict__ds 'idThumb as LocalThumbID, name as LocalImageFile, idPath as LocalPathID from Thumbnail'
rc=. sqlclose__ds''

NB. use symbols - local file list is large
(0{"1 du)=. 1 {"1 du
LocalImageFile=. s: LocalImageFile
'invalid manual local image(s)' assert (#LocalImageFile) > pos=. LocalImageFile i. s: lf {"1 mc
lifp=. pos

NB. match on path id and local file name
pos=. (LocalPathID ,. i.~ LocalImageFile) i. lpid ,. lifp
'missing manual local path image pairs(s)' assert pos < #LocalImageFile
ltid=. pos { LocalThumbID

NB. insert manual local online pairs in LocalImage table
cln=. ;:'LocalPathID LocalThumbID LocalImageFile ImageKey'
du=. lpid;ltid;(lf {"1 mc);<olik
dt=. sqlopen_psqlite_ trg
rc=. sqlinsert__dt 'LocalImage';cln;<du
rc [ sqlclose__dt ''
)

MatchOnlineLocal=:3 : 0

NB.*MatchOnlineLocal v-- match online files with local files.
NB.
NB. Online files are, with few  exceptions, JPG files while local
NB. files are mostly  TIF files. This verb exactly matches online
NB. file names with  local names. This exact  match picks up over
NB. 1500  images which is  better than  I  expected. Matching all
NB. online  images  to  local  files  will be  an ongoing  little
NB. project.
NB.
NB. verbatim: online files are:
NB.
NB.  1. often renamed
NB.  2. retyped (tif,nef -> jpg)
NB.  3. can derive from many originals (panoramas)
NB.
NB. monad: iaRc = MatchOnlineLocal (clThumbsDb ; clMirrorDb)
NB.
NB.   src=. 'c:/thumbsdbs/primary2018.tpdb8s'
NB.   trg=. 'c:/smugmirror/documents/xrefdb/mirror.db'
NB.   MatchOnlineLocal src;trg

'src trg'=. y
ds=. sqlopen_psqlite_ src
dt=. sqlopen_psqlite_ trg

NB. local file names and ids !(*)=. idPath idThumb name
ld=. sqldict__ds 'idPath, idThumb, name from Thumbnail'
(0 {"1 ld)=. 1 {"1 ld
rc=. sqlclose__ds ''
local=. justfile&.> name

NB. online ImageKey and file names !(*)=. ImageKey OnlineImageFile
td=. sqldict__dt 'ImageKey, OnlineImageFile from OnlineImage'
(0 {"1 td)=. 1 {"1 td
OnlineImageFile=. justfile&.> OnlineImageFile

NB. local/online exact matches
pos=. local i. OnlineImageFile [ rc=. 0
if. #mch=. pos -. #local do.

  NB. insert matched
  NB. NOTE: thumbs cols renamed,  idPath -->> LocalPathID, idThumb -->> LocalThumbID
  clns=. ;:'LocalPathID LocalThumbID LocalImageFile ImageKey'
  dat=. (mch{idPath);(mch{idThumb);(mch{name);<(pos < #local)#ImageKey
  dat=. 'LocalImage';clns;<dat
  rc=. sqlinsert__dt dat

end.

rc [ sqlclose__dt ''
)

MatchOnlineNoBrackets=:3 : 0

NB.*MatchOnlineNoBrackets v-- match online files with local files
NB. without [] suffix.
NB.
NB. For many years  I attempted  to pair online images with local
NB. images by affixing a bracketed suffix with the online  key in
NB. square [] brackets. When I  migrated many  of my images  from
NB. Flickr  to SmugMug I  stripped  the bracket  suffix from many
NB. file names.  By  removing  bracket  suffixes  more  than  700
NB. matches  can  be added  to  what  (MatchOnlineLocal)  already
NB. found.
NB.
NB. monad:  iaRc = MatchOnlineNoBrackets (clThumbsDb ; clMirrorDb)
NB.
NB.   src=. 'c:/thumbsdbs/primary2018.tpdb8s'
NB.   trg=. 'c:/smugmirror/documents/xrefdb/mirror.db'
NB.   MatchOnlineNoBrackets src;trg

'src trg'=. y
ds=. sqlopen_psqlite_ src
dt=. sqlopen_psqlite_ trg

NB. local file names and ids !(*)=. idPath idThumb name
ld=. sqldict__ds 'idPath, idThumb, name from Thumbnail'
(0 {"1 ld)=. 1 {"1 ld
rc=. sqlclose__ds ''

NB. strip [] suffixes from local file names
bm=. *./@('[]'&e.) &> name
if. -.1 e. bm do. rc [ sqlclose__dt '' return. end.

NB. remove image without []'s
name=.    bm # name
idPath=.  bm # idPath
idThumb=. bm # idThumb
local=. alltrim@('['&beforestr)&.> name

NB. removing suffixes might create duplicates 
bm=. ~:local
if. -.1 e. bm do. rc [ sqlclose__dt '' return. end.
local=.   bm # local
name=.    bm # name
idPath=.  bm # idPath
idThumb=. bm # idThumb

NB. online ImageKey and file names !(*)=. ImageKey OnlineImageFile
td=. sqldict__dt 'ImageKey, OnlineImageFile from OnlineImage'
(0 {"1 td)=. 1 {"1 td
OnlineImageFile=. justfile&.> OnlineImageFile

NB. local/online exact matches after suffixes removed
pos=. local i. OnlineImageFile [ rc=. 0
if. #mch=. pos -. #local do.

  NB. insert matched
  NB. NOTE: thumbs cols renamed,  idPath -->> LocalPathID, idThumb -->> LocalThumbID
  clns=. ;:'LocalPathID LocalThumbID LocalImageFile ImageKey'
  dat=. (mch{idPath);(mch{idThumb);(mch{name);<(pos < #local)#ImageKey
  dat=. 'LocalImage';clns;<dat
  rc=. sqlinsert__dt dat

end.

rc [ sqlclose__dt ''
)

MirrorImageTable=:3 : 0

NB.*MirrorImageTable v-- scan all manifest files and return an image table.
NB.
NB. monad:  btclImage =. MirrorImageTable clRoot
NB. 
NB.   img=. MirrorImageTable 'c:/SmugMirror/Mirror'

NB. z locale !(*)=. dirtree
img=. 0 0$a:
if. #files=. dirtree (tslash2 y),'manifest-*.txt' do.

  NB. for each manifest file there is a real date file
  'missing real date file(s)' assert fexist rdfiles=. RealDateFrManifest 0 {"1 files

  NB. all manifest/real date files have same layout get headers
  head=. 0{readtd2 ;0{0{files
  'image album'=. head i. ;:'ImageKey AlbumKey'
  'missing (ImageKey, AlbumKey) column(s)' assert (image,album) < #head
  
  NB. merge all manifest files and reduce on image key
  img=. ; }.@readtd2&.> 0 {"1 files
  img=. img #~ ~: image {"1 img

  NB. insert new columns in table schema order
  b=. 1 1 1 0 1 1 1 1 1 1 1 0 1 1 1 1 1 1
  img=. b (#^:_1)"1 img
  head=. b (#^:_1) head

  NB. rename FileName -->> OnlineImageFile and insert new column names
  head=. (<'OnlineImageFile') (head i. <'FileName')} head
  head=. (;:'MirrorImageFile RealDate') (I. -.b)} head

  NB. update column positions
  'image imdate'=. head i. ;:'ImageKey RealDate'

  NB. merge in real dates
  rdhead=. 0{readtd2 ;0{0{rdfiles
  'rdimage rddate'=. rdhead i. ;:'ImageKey RealDate'
  'missing (ImageKey, RealDate) column(s)' assert (rdimage,rddate) < #rdhead
  rd=. ; }.@readtd2&.> rdfiles
  if. #pos=. ((image {"1 img) i. rdimage {"1 rd) -. #img do.
    img=. (rddate {"1 rd) (<pos;imdate)} img
  end.
  
  NB. image table
  img=. head , img
else.
  img
end.
)

MirrorImageXrTables=:3 : 0

NB.*MirrorImageXrTables  v--  scan  manifest/realdate  files  and
NB. return image and imagealbum xref tables.
NB.
NB. monad:  ((<btclImage), <btclXref) =. MirrorImageXrTables clRoot
NB.
NB.   'img xref'=. MirrorImageXrTables 'c:/SmugMirror/Mirror'

NB. z locale !(*)=. dirtree
img=. 2#<0 0$a:
if. #files=. dirtree (tslash2 y),'manifest-*.txt' do.

  NB. for each manifest file there is a real date file
  'missing real date file(s)' assert fexist rdfiles=. RealDateFrManifest 0 {"1 files

  NB. all manifest/real date files have same layout get headers
  head=. 0{readtd2 ;0{0{files
  'image album'=. head i. ;:'ImageKey AlbumKey'
  'missing (ImageKey, AlbumKey) column(s)' assert (image,album) < #head

  NB. read all manifest files
  img=. ; }.@readtd2&.> 0 {"1 files

  NB. image album cross reference - insure unique rows
  iax=. ~. ((image,album){head) , (image,album) {"1 img

  NB. reduce on image key - there are duplicate
  NB. images in the python smugpyter directories
  b=. head ~: <'AlbumKey'
  img=. b #"1 img [ head=. b # head
  img=. img #~ ~: image {"1 img

  NB. insert new column in table schema order
  b=. 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1
  img=. b (#^:_1)"1 img
  head=. b (#^:_1) head

  NB. rename FileName -->> OnlineImageFile and insert new column
  head=. (<'OnlineImageFile') (head i. <'FileName')} head
  head=. (<'RealDate') (I. -.b)} head

  NB. update column positions
  'image imdate'=. head i. ;:'ImageKey RealDate'

  NB. merge in real dates
  rdhead=. 0{readtd2 ;0{0{rdfiles
  'rdimage rddate'=. rdhead i. ;:'ImageKey RealDate'
  'missing (ImageKey, RealDate) column(s)' assert (rdimage,rddate) < #rdhead
  rd=. ; }.@readtd2&.> rdfiles
  pos=. (image {"1 img) i. rdimage {"1 rd
  if. +./b=. pos < #img do.
    pos=. b # pos 
    img=. (b # rddate {"1 rd) (<pos;imdate)} img
  end.

  NB. image table and xref
  (<head,img),<iax
else.
  img
end.
)

MirrorImageXrefTables=:3 : 0

NB.*MirrorImageXrefTables v-- scan all manifest files and return image and album xref tables.
NB.
NB. monad:  ((<btcl) , <btcl) =. MirrorImageXrefTables clRoot
NB. 
NB.   k=. MirrorImageXrefTables 'c:/SmugMirror/Mirror'
NB.
NB. dyad:  ((<btcl) , <btcl) = clPat MirrorImageXrefTables clRoot
NB.
NB.   'changes-*.txt' MirrorImageXrefTables 'c:/SmugMirror/Mirror' 

'manifest-*.txt' MirrorImageXrefTables y
:
NB. z locale !(*)=. dirtree
kw=. 2 # <0 0$a:
if. #files=. dirtree (tslash2 y),x do.
  NB. all files have same layout get header
  head=. 0{readtd2 ;0{0{files
  'image album'=. head i. ;:'ImageKey AlbumKey'
  'missing (ImageKey, AlbumKey) column(s)' assert (image,album) < #head
  kw=. ; }.@readtd2&.> 0 {"1 files
  imgtab=. head , kw #~ ~: image {"1 kw
  imgalbxref=. ((image,album) { head) , (image,album) {"1 kw
  NB. unique image table & image x album cross reference
  (<imgtab),<imgalbxref
else.
  kw
end.
)

MirrorImages=:3 : 0

NB.*MirrorImages v-- scans all manifest/changes files and returns image keys as symbols.
NB.
NB. monad:  sl =. MirrorImages clRoot
NB. 
NB.   k=. MirrorImages'c:/SmugMirror'
NB.
NB.   NB. first ten images occurring in more than one gallery
NB.   10 ,.@{.&.> ofreq k
NB.
NB. dyad:  sl = (clPat ; caDel) MirrorImages clRoot
NB.
NB.   ('changes-*.txt';';') MirrorImages 'c:/SmugMirror' 

('manifest-*.txt';';') MirrorImages y
:
'pat delim'=. x
NB. z locale !(*)=. dirtree
kw=. 0$s:<''
if. #files=. dirtree (tslash2 y),pat do.
  NB. all files have same layout get position of images
  head=. 0{readtd2 ;0{0{files
  keypos=. head i. <'ImageKey'
  'no (ImageKey) column' assert keypos < #head
  NB. define key extraction verb
  kdv=. }.@(keypos&{"1@readtd2)
  s: ;kdv&.> 0 {"1 files 
else.
  kw
end.
)

MirrorKeywords=:3 : 0

NB.*MirrorKeywords v-- scans all manifest/changes files and returns keywords as symbols.
NB.
NB. monad:  sl =. MirrorKeywords clRoot
NB. 
NB.   k=. MirrorKeywords 'c:/SmugMirror/Mirror'
NB.
NB.   NB. top 25 keywords
NB.   25 ,.@{.&.> ofreq k
NB.
NB. dyad:  sl = (clPat ; caDel) MirrorKeywords clRoot
NB.
NB.   ('changes-*.txt';';') MirrorKeywords 'c:/SmugMirror/Mirror' 

('manifest-*.txt';';') MirrorKeywords y
:
'pat delim'=. x
NB. z locale !(*)=. dirtree
kw=. 0$s:<''
if. #files=. dirtree (tslash2 y),pat do.
  NB. all files have same layout get position of keywords
  head=. 0{readtd2 ;0{0{files
  keypos=. head i. <'Keywords'
  'no (Keyword) column' assert keypos < #head
  NB. define key extraction verb
  kdv=. }.@(keypos&{"1@readtd2) 
  keys=. ;kdv&.> 0 {"1 files
  keys=. (;delim ,&.> keys) -. ' '
  if. #keys=. <;._1 keys do. s: keys else. kw end.
else.
  kw
end.
)

MirrorMD5=:3 : 0

NB.*MirrorMD5 v-- scans all manifest/changes files and returns image MD5s as symbols.
NB.
NB. monad:  sl =. MirrorMD5 clRoot
NB. 
NB.   k=. MirrorMD5'c:/SmugMirror'
NB.
NB.   NB. first ten images occurring in more than one gallery
NB.   10 ,.@{.&.> ofreq k
NB.
NB. dyad:  sl = (clPat ; caDel) MirrorMD5 clRoot
NB.
NB.   ('changes-*.txt';';') MirrorMD5 'c:/SmugMirror' 

('manifest-*.txt';';') MirrorMD5 y
:
'pat delim'=. x
NB. z locale !(*)=. dirtree
kw=. 0$s:<''
if. #files=. dirtree (tslash2 y),pat do.
  NB. all files have same layout get position of MD5s
  head=. 0{readtd2 ;0{0{files
  keypos=. head i. <'ArchivedMD5'
  'no (ArchivedMD5) column' assert keypos < #head
  NB. define key extraction verb
  kdv=. }.@(keypos&{"1@readtd2)
  s: ;kdv&.> 0 {"1 files 
else.
  kw
end.
)

MirrorMD5s=:3 : 0

NB.*MirrorMD5s v-- scans all manifest/changes files and returns image MD5s as symbols.
NB.
NB. monad:  sl =. MirrorMD5s clRoot
NB. 
NB.   k=. MirrorMD5s 'c:/SmugMirror'
NB.
NB.   NB. first ten images occurring in more than one gallery
NB.   10 ,.@{.&.> ofreq k
NB.
NB. dyad:  sl = (clPat ; caDel) MirrorMD5s clRoot
NB.
NB.   ('changes-*.txt';';') MirrorMD5s' c:/SmugMirror' 

('manifest-*.txt';';') MirrorMD5s y
:
'pat delim'=. x
NB. z locale !(*)=. dirtree
kw=. 0$s:<''
if. #files=. dirtree (tslash2 y),pat do.
  NB. all files have same layout get position of MD5s
  head=. 0{readtd2 ;0{0{files
  keypos=. head i. <'ArchivedMD5'
  'no (ArchivedMD5) column' assert keypos < #head
  NB. define key extraction verb
  kdv=. }.@(keypos&{"1@readtd2)
  s: ;kdv&.> 0 {"1 files 
else.
  kw
end.
)

MissingImagesReport=:3 : 0

NB.*MissingImagesReport v-- missing local images report.
NB.
NB. monad:  clReportFile =. MissingImagesReport (clMissingFile ; clMirrorDb)
NB.
NB.   mli=. 'c:/smugmirror/documents/xrefdb/locomiss.txt'
NB.   trg=. 'c:/smugmirror/documents/xrefdb/mirror.db'
NB.   MissingImagesReport mli;trg

'mli trg'=. y

NB. switch to portable box characters 
portchars '' [ cchars=. 9!:6 ''
dt=. sqlopen_psqlite_ trg
dat=. ctl ": sqlreads__dt MissingLocalFiles_sql
9!:7 cchars [ sqlclose__dt ''

NB. write report text
mli [ (toHOST dat) write mli
)

RealDateFrManifest=:3 : 0

NB.*RealDateFrManifest v-- real date files from manifest files.
NB.
NB. monad:  pl =. RealDateFrManifest blclManifestFiles
NB.
NB.   RealDateFrManifest 0 {"1 dirtree jpath '~temp/manifest-*.txt'

NB. assumes use of (dirtree) - hence / path delimiter
paths=. tslash2&.> '/'&beforelaststr&.> y
paths ,&.> 'realdate-'&,&.> (#'manifest-') }.&.> '/'&afterlaststr&.> y
)

UpdateLocalPresent=:3 : 0

NB.*UpdateLocalPresent v--  set (LocalPresent) in (Album) to 1 if
NB. all local images exist.
NB.
NB. monad:  iaRc =. UpdateLocalPresent clMirrorDb
NB.
NB.   trg=. 'c:/smugmirror/documents/xrefdb/mirror.db'  NB. smugmug mirror
NB.   UpdateLocalPresent trg

NB. get albums !(*)=. AlbumKey AlbumName
rc=. 0
dt=. sqlopen_psqlite_ y
al=. sqldict__dt 'AlbumKey, AlbumName from Album'
(0 {"1 al)=. 1 {"1 al
if. 0=#AlbumKey do. rc [ sqlclose__dt '' return. end.

bok=. 0 #~ #AlbumKey
for_pos. i.#AlbumKey do.
  ak=. ;pos{AlbumKey
  an=. ;pos{AlbumName
  smoutput 'Checking ',an,' ...'
  files=. dt LocalFrOnline ak
  b=. fexist files
  if. (0 e. b) *. 0 < #files do.
    smoutput 'missing local album sample file(s)'
    smoutput >files # -.b
  else.
    NB. all album files present
    bok=. 1 pos} bok

    NB. NOTE: faster to scan all files and issue one update
    NB. WARNING: this method leaves (mirror.db) open despite
    NB. being closed in all cases - this is not a problem when
    NB. run from (buildmirror.bat) that terminates the entire 
    NB. process and closes (mirror.db).
    NB. rc=. sqlparm__dt UpdateLocalPresent_sql;SQLITE_TEXT_psqlite_;ak
    NB. if. rc ~:0 do. break. end.

  end.
end.

NB. issue one update
if. 1 e. bok do.
  sql=. UpdateLocalPresent_sql,'(',(}.;',' ,&.> quote&.> bok#AlbumKey),')'
  rc=. sqlcmd__dt sql 
end.

rc [ sqlclose__dt ''
)

b36casemask=:3 : 0

NB.*b36casemask v-- case mask encoded as base 36 string.
NB.
NB. This verb must match the python (case_mask_encode)  function.
NB. See the macro (base36_py) for details.
NB.
NB. monad:  blcl =. b36casemask blclKeys
NB.
NB.   b36casemask  <'7ZdVjvN'
NB.
NB.   keys=. <;._1 ' bKq6rXc 6wpcfgH SCVLN82 6bb47N7 gQhBGBw GSM47GW z78dtXv hH8C2Sz M58pxN7 JvZb6gp'
NB.   b36casemask keys

c=. b36fd #. 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' e.~ > ,y

NB. suppress leading zeroes to match python
c=. ' ' (<(I. '0' = 0 {"1 c);0)} c
(<"1 c) -.&.> ' '
)

colorkeyfreq=:3 : 0

NB.*colorkeyfreq v-- color key frequencies from changes/manifest files.
NB.
NB. monad:  colorkeyfreq clSmugMirrorRoot
NB.
NB.   colorkeyfreq 'c:/SmugMirror'
NB.
NB. dyad:  clPrefix colorkeyfreq clSmugMirrorRoot
NB.
NB.   'manifest-*.txt' colorkeyfreq 'c:/SmugMirror'

'changes-*.txt' colorkeyfreq y
:
k=. (x;';') MirrorKeywords y

NB. color keywords
'k f'=. ofreq k #~ DominantColorPfx -:"1 [  0 1 {"1 [ 4 s: k
c=. 100 * +/\ f % +/ f

NB. frequency summary
s=. ,.&.> (>: i. #k);k;f;(100 * f % +/f);c;+/\. f
(<;._1 ';count;color key;frequency;percent;cummulative;reverse') ,: s
)

createMirrorXrefDb=:3 : 0

NB.*createMirrorXrefDb v-- creates sqlite mirrorxref database.
NB.
NB. monad:  bclObj = createMirrorXrefDb clPathDbFile
NB.
NB.   db=: createMirrorXrefDb 'C:/SmugMirror/Documents/XrefDb/mirrorxref.db' 

sqlcreate_psqlite_ y
)

createMirrorXrefTables=:3 : 0

NB.*createMirrorXrefTables v-- create tables in mirrorxref database.
NB.
NB. monad:  createMirrorXrefTables bclObj
NB.
NB.   db=: sqlopen_psqlite_ 'C:/SmugMirror/Documents/XrefDb/mirrorxref.db' 
NB.   createMirrorXrefTables db 

db=. y

sqlcreate__db imageSchema_sql
)

debrii=:3 : 0

NB.*debrii v-- write shell script that removes debrii files.
NB.
NB. Note: tuned for windows - tweak for others.
NB.
NB. monad:  clBatFile =. debrii clRoot
NB.
NB.   debrii 'h:/'
NB.
NB. dyad:  clBatFile =. (clBatFile ; blclExt) debrii clRoot
NB.
NB.   ('h:/temp';<;:'txt pdf') debrii 'h:/'

(DEBRIIBAT;<DEBRIIEXT) debrii y
:
'file ext'=. x 
NB. j profile !(*)=. dirtree
d=. 0 {"1 dirtree y
NB. extensions are not case sensitive
b=. (tolower@justext&.> d) e. tolower&.> ext
t=. toHOST ctl '/\' charsub >'del '&,&.> dblquote b#d
file [ t write file
)

degeotag=:3 : 0

NB.*degeotag v-- remove geotagged keyword from images with nonzero latitude and longitude.
NB.
NB. monad:  btcl =. degeotag btclImages
NB.
NB.   img0=. readtd2 'C:\SmugMirror\Places\Overseas\Ghana1970s\manifest-Ghana1970s-Kng6tg-w.txt'
NB.   img1=. readtd2 'C:\SmugMirror\People\GreatandGreaterForebearers\manifest-GreatandGreaterForebearers-XghWcL-11.txt'
NB.   img2=. readtd2 'C:\SmugMirror\Themes\Diaries\CellPhoningItIn\manifest-CellPhoningItIn-PfCsJz-16.txt'
NB.
NB.   degeotag img0
NB.   degeotag img1

'geotagged' degeotag y
:
d=. }.y [ h=. 0{y
'missing (Keyword, Latitude, Longitude) column(s)' assert -.(#h) e. 'k l b' =. h i. ;:'Keywords Latitude Longitude'

NB. items with nonzero latitude or longitude
lb=. (l,b) {"1 d
if. 0=#p=. I. +./"1 ] 0 ~: (0 < #&> lb) * 0&".&> lb do. y return. end.

NB. items with (x) keyword
t=. (<p;k){ d
if. 0=#q=. I. +./@(x&E.) &> t do. y return. end.

NB. remove (x) keyword(s)
h , (x rekeyword t) (<p;k)} d
)

dpiarearatio=:3 : 0

NB.*dpiarearatio v-- print area and aspect ratio for image dimensions at given DPI.
NB.
NB. monad:  fa =. dpiarearatio ilWidthHeight
NB.
NB.   dpiarearatio 2000 3000
NB.   dpiarearatio |: 10 # ,: 4888,3256
NB. 
NB. dyad:  fa =. faAspectDP1 dpiarearatio ilWidthHeight
NB.
NB.   0.0005 0.05 500 dpiarearatio 2000 3000

(SMUGASPECTROUND,SMUGAREAROUND,SMUGPRINTDPI) dpiarearatio y
:
'aspect area dpi'=. x
(area round (*/y) % *: dpi) ,: aspect round (<./y) % >./y
)

fmtkeys=:3 : 0

NB.*fmtkeys v-- format print keys.
NB.
NB. monad:  fmtkeys stKeys

ctl ;"1 (5 s: |: y) ,&.> <'  '
)

geotag=:3 : 0

NB.*geotag v-- add geotagged keyword to images with nonzero latitude and longitude.
NB.
NB. monad:  btcl =. geotag btclImages
NB.
NB.   img0=. readtd2 'C:\SmugMirror\Places\Overseas\Ghana1970s\manifest-Ghana1970s-Kng6tg-w.txt'
NB.   img1=. readtd2 'C:\SmugMirror\People\GreatandGreaterForebearers\manifest-GreatandGreaterForebearers-XghWcL-11.txt'
NB.   img2=. readtd2 'C:\SmugMirror\Themes\Diaries\CellPhoningItIn\manifest-CellPhoningItIn-PfCsJz-16.txt'
NB.
NB.   geotag img0
NB.   geotag img1

'geotagged' geotag y
:
d=. }.y [ h=. 0{y
'missing (Keyword, Latitude, Longitude) column(s)' assert -.(#h) e. 'k l b' =. h i. ;:'Keywords Latitude Longitude'

NB. items with nonzero latitude or longitude
lb=. (l,b) {"1 d
if. 0=#p=. I. +./"1 ] 0 ~: (0 < #&> lb) * 0&".&> lb do. y return. end.

NB. items without (x) keyword
t=. (<p;k){ d
if. 0=#q=. I. -. +./@(x&E.) &> t do. y return. end.

NB. insert change(s)
h , (((<x,'; ') ,&.> q{t) q} t) (<p;k)} d
)

insqltd=:4 : 0

NB.*insqltd v-- insert btcl table into sqlite table.
NB.
NB. dyad:  iaRc =. baObj insqltd (clSqlTable ;< btclData)
NB.
NB.   db=. sqlopen_psqlite_ jpath '~temp\dntest.db'
NB.   dat=. readtd2 'C:\Users\john2000\j64-807-user\temp\dn_dv.txt'
NB.   db insqltd 'dntest';<dat

'tab dat'=. y
st=. sqltables__x ''
'missing database table' assert st e.~ <tab
cl=. sqlcols__x tab
'missing table column(s)' assert cl e.~ 0{dat
sqlinsert__x tab;(0{dat);< <"1 |: }.dat
)

ofreq=:[: (([: < [: \: [: ; 1 { ]) {&.> ]) ~. ; #/.~

printsizekey=:3 : 0

NB.*printsizekey v-- j version of python (print_size_key).
NB.
NB. monad:  st =. printsizekey btclManifest
NB.
NB.   mf0=. readtd2 'C:\SmugMirror\Places\Overseas\Ghana1970s\manifest-Ghana1970s-Kng6tg.txt'
NB.   mf1=. readtd2 'C:\SmugMirror\Themes\Diaries\CellPhoningItIn\manifest-CellPhoningItIn-PfCsJz.txt'
NB.   printsizekey mf0
NB.   printsizekey mf1
NB.
NB. dyad:  st =. iaDpi printsizekey btclManifest
NB.
NB.   720 printsizekey mf1

SMUGPRINTDPI printsizekey y
:
NB. image keys and dimensions 
d=. y {"1~ (0{y) i. ;:'ImageKey OriginalHeight OriginalWidth'
f=. |: _1&".&> d=. 1 2 {"1 }. d
'invalid image dimensions' assert 0 < ,f

NB. default print size keys
'area ratio'=. (SMUGASPECTROUND,SMUGAREAROUND,x) dpiarearatio f 
keys=. (#ratio) # s: <NORATIOKEY

NB. print sizes for image ratios
pst=.  SMUGASPECTROUND printsizestable SMUGPYTERSIZES
ast=.  ;0{"1 pst
m0=.   ratio e. ast
idx=.  (ast i. ratio) -. #ast
pst=.  idx { pst

NB. images without enough pixels
area=. <"0 m0 # area
m1=.   (1 {"1 pst) <&.> area
m2=.   +./&> m1
keys=. (s: <NOPIXELSKEY) (I. m0 #^:_1 -. m2)} keys

NB. largest print sizes for enough pixels
sizes=. ,(I.@lastones&.> m2#m1) {&> 2 {"1 m2#pst
keys=. sizes(I. m0 #^:_1 m2)} keys

NB. image keys, print size keys, pixels
NB. smoutput (<"0  m0 # keys) ,. area ,. pst 
(s: }.0 {"1 y) , keys , |: s: d 
)

printsizestable=:3 : 0

NB.*printsizestable v-- computes print sizes table.
NB.
NB. monad:  bt=. printsizestable blclPrintSizes
NB.
NB.   printsizestable SMUGPYTERSIZES
NB.   printsizestable <;._1 ' ',reb '10x10 20x30   3x2 2x3 12x8  8x12 10x10   '
NB.
NB. dyad:  bt=. faPrecision printsizestable blclPrintSizes
NB.
NB.   0.00005 printsizestable SMUGPYTERSIZES   

SMUGASPECTROUND printsizestable y
:
sizes=. sortprintsizes y
ratios=. ".&> 'x%'&charsub&.> sizes
areas=.  ".&> 'x*'&charsub&.> sizes

NB. sizes with same ratio, eg: 4x5, 8x10, 4x6, 8x12
aspect=. ((~.ratios) i. ratios) </. i. #ratios

NB. columns: ratio, areas, print sizes
(<"0 x round ~.ratios) ,. (aspect {&.> <areas) ,. s:&.> aspect {&.> <sizes
)

rekeyword=:[: 2&}.@;&.> [: '; '&,L:0 ([: <;._1&.> ';' ,&.> ' ' -.&.>~ ]) -.&.> [: < [: < [

sizekey=:3 : 0

NB.*sizekey v-- size key from image dimensions.
NB.
NB. monad:  st =. sizekey ilWidthHeight | itWidthHeight
NB.
NB.   sizekey 1544 2501
NB.   sizekey 5 #"1 ,. 1544 2501
NB.   sizekey 2000 2000 ,: 3000 3000
NB.
NB. dyad:  st =. iaDpi printsizekey btclManifest
NB.
NB.   720 sizekey 4000 6000
NB.   720 sizekey |: 2000 # ,: 4000 6000

SMUGPRINTDPI sizekey y
:
'invalid image dimensions' assert (2 = #y) , 0 < ,y

NB. default print size keys
'area ratio'=. (SMUGASPECTROUND,SMUGAREAROUND,x) dpiarearatio y 
keys=. (#ratio) # s: <NORATIOKEY

NB. print sizes for image ratios
pst=.  SMUGASPECTROUND printsizestable SMUGPYTERSIZES
ast=.  ;0{"1 pst
m0=.   ratio e. ast
idx=.  (ast i. ratio) -. #ast
pst=.  idx { pst

NB. images without enough pixels
area=. <"0 m0 # area
m1=.   (1 {"1 pst) <&.> area
m2=.   +./&> m1
keys=. (s: <NOPIXELSKEY) (I. m0 #^:_1 -. m2)} keys

NB. largest print sizes for enough pixels
sizes=. ,(I.@lastones&.> m2#m1) {&> 2 {"1 m2#pst
sizes(I. m0 #^:_1 m2)} keys
)

smugprintsizes=:3 : 0

NB.*smugprintsizes v-- compute largest print size for given dpi.
NB.
NB. Computes the  largest  print size  (relative  to  DPI x)  for
NB. SmugMug images. Only images that have aspect ratios  close to
NB. the ratios  on  (SMUGPRINTSIZES) are associated  with a print
NB. size.
NB.
NB. monad:  st=. smugprintsizes btclImages
NB.
NB.   NB. read table delimited (smugpyter.py) album file
NB.   images=. readtd2 'c:\SmugMirror\People\TheWayWeWere\manifest-TheWayWeWere-X8X9pK.txt'
NB.   'keys sizes'=. |: smugprintsizes images
NB.
NB. dyad:  st=. iaDpi smugprintsizes btclImages
NB.
NB.   NB. images are dropped if there are not enough pixels for DPI
NB.   #images
NB.   #600 smugprintsizes images

SMUGPRINTDPI smugprintsizes y
:
nsym=.s:<''

NB. reduce image table on PID
images=. }. y [ imhead=. 0 { y
pidpos=. imhead i. <'ImageKey'
if. 0=#images=. images #~ ~:pidpos {"1 images do. 0 2$nsym return.end.

NB. compute print sizes table
pst=. SMUGASPECTROUND printsizestable SMUGPRINTSIZES

NB. image dimensions short x long
idims=. _1&".&> (imhead i. ;:'OriginalWidth OriginalHeight') {"1 images
'invalid image dimensions' assert -. _1 e. idims

NB. aspect ratio and print area (square inches)
'areas ratios'=. (SMUGASPECTROUND,SMUGAREAROUND,x) dpiarearatio |: idims

NB. mask table selecting images with ratio
masks=. (;0 {"1 pst) =/ ratios
if. -.1 e. ,masks do. 0 2$nsym return.end.

masks=. <"1 masks
pids=.  s:&.> masks #&.> <pidpos {"1 images

NB. largest print area for selected images at current DPI
masks=. (1 {"1 pst) </&.> masks #&.> <areas
pids=.  (<"1&.> masks #"1 &.> pids) -. L: 0 nsym
sizes=.  <"0&.> 2 {"1 pst
; |:&.> ; pids ,: L: 0 (# L: 0 pids) # L: 0 sizes
)

sortprintsizes=:3 : 0

NB.*sortprintsizes v-- sort print sizes as ascending unique Short x Long,  
NB.
NB. monad:  sortprintsizes clPrintSizes
NB. 
NB.   sortprintsizes SMUGPRINTSIZES
NB.   sortprintsizes <;.1 ' ',reb '10x10 20x30   3x2 2x3 12x8  8x12 10x10   '

(~. ' x'&charsub&.> ":&.> /:~ (/:~)&.> ".&.> 'x '&charsub&.> y) -.&.> ' '
)

showpass soput ".'nl_',SOLOCALE,'_ i.4' [ cocurrent 'base' NB.{*JOD*}
".soclear NB.{*JOD*}
cocurrent SO__JODobj NB.{*JOD*}
zz=:dec85__MK__JODobj 0 : 0
1H7-42DlU4+>G\q2)-4.3$:%7+>GSn1,U1/0H`5/+>Ghu1c?I22BXb3+?:Q%1a"e$1cHO32BXb8
+>PYo1H?R50H`2/+?1K"1E\Y"1bp16+>Ghu0fC.02'=V5+>Pku0f'q-1*A;0+>beq0f:(/1a"M3
+>Pht0f'q-1a"M/+>c#"0f^@72BX_4+>c#"0eje/0d&Fu1GU(-0H`,1+>GSn1cZ[52BXe5+>PYo
2)?@02BXh:+>Gl!2_lL20d&A0+>GVo2Du[41a"\5+>GPm2Du[43?U(9+>PYo2)QL20d&A.+>GPm
3%uI03?U+;+>Ghu1Gp:01E\M6+>G_r2`2^41*AG4+>G\q1cHO31a"\9+>GPm1cQU43$:+5+>P\p
2)QL21*AM2+>GSn1Gp:01*AD6+>t?!1a"b#2_lL11*AJ0+>t?#2]t%%1Gp:4+>c#"0esk-2BXb5
+>Po!0f:(/2BY"&2DH=/1a"V/+>G\q2)%=4@WcNa@<?0^@:F%a@rH4'Ch7^"+Dbt+@;I'*@<?0*
FCAWpAKYT*Df$V*CgqO(+E1b0ASuT4AoDKrATDiY@:O(QE(t%eEc5u#Eb/iN@U`bUCNXS=D/"$2
DfQt2@<>pe@<6!&@;]TuATD4#AKY]!+=MI`+DGm>0g^"sCh-7SEcQ)=@UWb^F`9!DEb/[$AM7k<
@:UKtBl\64E^Nc(?UJaJDfTo@@:F%a+E(j7F*(i.A79Lh+@B(++Cf>+DfQt<@;TRs/0IJP=<M$i
A0=c?66LG[Cis<16ZQaHFCe0\EcQ)==E7tb6t0YHART[lF!,ODCh\!&+Dkh5Ec5t@@rcL/F!,L7
An?!oDI[6#A79Rg@UX=h6ZQaHFCe0\EcQ)=?ZU4';FO&D;FO>J762Q4EGT?2AKYi(EcQ)=6q'F?
8P)67<+^8hCj@.CF^]*#Anbge+C\c$@q[N:BOu!r+EM%5BlJ/:GB.D>FCf>4@X0(EA7]4jBk]"a
77'mD8OZ`\@VfOj+E(j7@psFi+DG_7ASuU(G%DdEA7]4jBk]"=Anc'm+D#e>ASuR'Df0VaDf'3+
@;^0SDes?4:hFrkEb/isGT^p:+CoD-Bl7?sF<G(3Ci=>:CLqd47!3?c9Q+ELCe8JPB4XhHFEMV4
Ch.[*E$-Q&De!3l8SqmKALSa1F!+FJ66KfMCh[a#FCeu*FCf]=8Oc!579<8_6rQfoEcQ)==E7tb
Bl8$(Eb8`iAKZ28Eb'56-qQlo6Ub'P;FFGXBl\64E`d?nAgnj8Ec6)>9M\#O9hA8^DIIBn+E(j7
D/"'4Bl7Q+Ci<flC`mG/@:s.m+D,>(AP>le:KUL`7W)XOAKYo'+E).6Bl7K)Ci<flC`m5.Df]tB
Eb/ioEb0,uAKZ)'@VfULDdd0BCgqO(Ci<`m+=KNl@WcN:+EV%$Ch6:Y@:VrH@:s.;CgqO(=E84r
@:UK/8SqmKAO1-AF_t6$.3N_@@VfULDdd0JD..'g94`BmDfTAjEboZ&A0<9lD..'g94`BmDfTAj
E[`,Q@:F%a9Q+?M9Q+ELCf"P^BP_TqA0<9oDe!3l:gnHZ.3N_@@VfULDdd0NBl\64E`d?nAjg*E
Ddd0t+Dtb7+Dkh5Ec5t@@rcL/F!,L7An?!oDI[6#A79Rg@UX=h9Q+?M:Msu_DIlCV@:s.fDdd0!
-r4_sBl7KRD..'g.3N_@@VfULDdd0PDJX$)AP6T[GAhM4Ci<`m+=L$'Ch[cu94`BmDfTA;+EV%$
Ch6:Y@ps1CBl%?fF)c"o77K^D78?3=3ZrK`Ch\!&+Dkh5Ec5tlDe!3l7WM:BCh[cuCi<flC`m>(
Ch4`,@;TRs+D,Y4D'3b7Ch[cu+DYP6F!+n/A0>JuCh7KmD.Rc^De!3l:Msu_DIl:OCh6spEGSNA
7R^3D:.%H2+Dbt+@;I')DJX$)AKYT!Ch4`+@<?!m+E;O8Ed8cZ+EM+*+=KruEcQ)==E7tb.3N;8
@:Wqi9gM-E:K'u%EcQ)==E7tbD.-ppDf[%0F)u80Bjl*pA0?)1FD)dF9gM-E:K'u%EcQ)==E7tb
.3N8DDfp"n5u(*L6Vgf^77M0'D.Oi.Afu#0Ch[cu+Dbt+@;I''@;^3rC`m5+EcP`$FD5Z2F!+t5
Df]tBEb/ioEb0,uAKZ)'@VfUM8Q&G^;FEimEGT?2AKYi(EcQ)=+Cno&@:EYdAKYT!Ch4`,@;TRM
8Q&G^;Fj5B6tg.?A0>f&+E1b2BHSlL@q]:gB4W2tDfQt=F%p(b@q\SFDKTB(Bl8!'Ec`F@@;^3r
C`mY6Ch[cu+Dbt+@;I'#D..'g+E1b'EZek1EcP`$FD5Z2F%p(b@q\YUCh[cu9Q+ELCi*U&@q[!'
DJX$)AKYT!Ch7Z1GA2/4+Dbt+@;I&uBl%@%9jr-RBMWM^Bl7KWDaJJQ@r#XtF)>?-@q[!'DJX$)
AKYT!Ch7Z1GA2/4+Dbt+@;I&uBl%@%+EqOABQ&$8+Br+oF*2),Bm<?dEcQ)=8SqmKAQ3)ICh7Zt
@;[2rCht52@;]dkATMr9Anc'mF!+n/A0>o(FEMVA+CT.1Bl.9kAKZ)'@VfUMBl\64E_1+VB4Y1c
<+06PATMp&@;[3)@;]dkATMrHEb/ZqA79Rk+D,>(ATJu&DIal1ATW'8DBNY1@:s-o@;]TuBl.9k
ARTCaF_r7GEb/i*FCAWpATLR[EcQ)=8SqmKAQWtaAlN2JCh7[/@ps6t@;Ka&D..<rAn?%*+D,>(
ATJu&DIal1ATW'8DBNY1@:s-o@;]Tu@;KCqD'4(DAS*',@:F%aF%p@hEc5tiD..'gF)ti"DK?q/
Cht52@;]dkATMrH@q]:gB4Z-,Anc'mF!+n/A0>o(FEMVAF!,16@:s-oCLqd4+CT=6F*VV3DesJh
Bl\64E_BthGAhM4F)ti"DK?q/Cht52@;]dkATMrH@q]:gB4Z-,Anc'mF!+n/A0>o(FEMVAF!,70
H$=1IA9/l%F!,OLD.7F"F%p@hEc5tm6oB%,@ps7r+CT)&+DkP)BkCptF>%-;@;]^hF!,(/Ch7Z1
@;]TuEb0?8Ec,q@Bl.9kAKX]8200mKF!,OLD.7F"F%p@iF(oN)8SqmKATLa\E,Tc=D/"'4Bl7Q+
Ci<flC`mG/@:s.m+ED%4DfTqoBle?0DJ)X]@ps1CBl%@%?ZU4';FO&D;FO>J762Q4EGQb-De*E%
Eb/ioEb0,uAKWQIF(Jo*-r"DrEc5u#Eb/i3+D>=pA7]dV:JaVb78-WQ79OD;H$=1IA0>T(A8,O^
FD5W*+DG\$B4W2rBl.F!F(oQ1F!,RC+EMC.Cht5+DfQt>EbTE5+EM7CATLUB;F+8R:J4,ZCLqd8
DfTA2Bl7Hq@psInDJ()+D..'g+Co2'ASuR'Df-\.D]iq9F<GF/FCSu,E,oZ1F<GX=H=_.?/KeqL
DKBo.DId0rA0>r,@;oe!;GU(f=&2^^;b^tHEc5u#Eb/j'Df9_?GAhM4F!)l/:JXqk:JsSZ9keWg
DfSs#AS*A6B6%p5E)L7UCd_]RAO^]7@;]dkATMs6ARTBtA79Rk+D,>(ATJu+Ec5e;D..<rAn?%*
+D,>(ATLdE<C]>Q76sgI<DGr&Dfor.+E(k(+D,P4+E2@8DKI"BF`M)&@q?ckEb/Z%.!'BN@<,p%
Bl7EoATK;!9iX\L;c#nM<)QLl:.0,@F`(_4De<T(AoD]4;f-Yi9m((k@<6C!@rri6@<?4%F!*%W
E,oN"Ble!,DBNe=F*&O8BleB1DJ+*+F(c\)Cht57@<?4%F&Pe57o3)T:/jVX8RuCE@<HC.+E2@8
DKI!h:e;c]+EM+9+EVNE<+pDk@WP@^F`S[B@:O=r+Eh10F_)\6Afrlf0N1\G7o3)T:/k.`>")A"
C`mY.+B)rlEc`FK+A?]kB-8U:DI[?kF"&51D09JcF_;h9EbTE5+EM7CATLdE<C]kg<(0\`8QnP]
E,oZ1F<GX=H=_.?FD,*)+DkP/@q[!.@;L't+DG^98p,)uFCfJ8DJsW.@W-1#F!+n/A0=]oFD,T1
+EM%5BlJ08;cZCq6Z6dZEcZ>2@VfTuDe:,5FCB&t@<,m$;cZC2@rH1%EZf7.D.Rc2@;]Tu;Fa%r
G%#30ATLjjA79Rk9Q+ELCf#.`F(K62F(KG9-qnPh@;Jb\ATMF#F=A>HDBL>nCgqO(.3N_N+>G!Q
AftMuC`mP4@ps0rBl.9kATJu*G\M5@<H)JWFCe-a@ps1MEb0<'DKK6,EGSNA7R^3D:.%H2+EMO=
+Cf>#AKZ#)An?!oDI[6#/Kf+GAKWBqBl\64E`d?nAgnj9ART+\E`Y[r?Vl#8Des?4F(9-)DfQt<
@;TRs+CT.u+@nq'+Eh10F_,V:AU&<;@:OCjA0>K)Df$UnH$!_<DBO.7@Uj=mDfTnAD/Ws-Ch4`1
Dfp)1AR[GR@psFiD..L$@psFi+DkP.CER2+@rGmhA0><%+C\c#AKWce+EMXFBl7QnDes?4CLqd'
Eb06#Des?4+DYP6+D,Y*EHPi1@qfLq+D,Y4D'3>%@;]^hF"_B=DJ<]oF*&O:Bl%@%A7]4jBk_d3
Blmo/F(f-$C`me/EbTK7+EV:*F<GU8D/XT/F!,")@WH0s+D,>(ATMBnB4Z"'@:sUlD/XT/+D58(
FCAfpARlp!AU/K<Eb$;)Ec5e;Bl.9kATJu<Bln#2DJsE=ATD]3CghF"FEM,*+CT.u+Dbt6B5)I1
A7]:jBjl$n@<,duBl@s2Bl8#8@<,pf+CT.u+CT>1ARfg)Eaa'(D]iY1EZf(5@:s-oA8,mlDKBN1
DK?q/F<G41G%GP66r6HfAT)[!B45=]+D58(FCAfpARlp!AU/K<Eb$;7D]ib2@:s.m+EqOABHV22
DL,l7D]ik)FD5i>A7ZllDIal+Df03%FEM,*Bl8!3Cij3%DKBB0F<G%7@r*90@:F%a+DG_8D]j+@
Ch\!&+EV%$Ch7NsEb06,Bkq9&-t[L2E@E#>F`\aHATN!1FE8R=DBNJ$F(8d!A8,po+D,Y*EHPi1
@sN$6Bl8$6BmO?+AU/#5G%G]8Bl@l3De:,2H$!_<DBL?HEbTE5?ZTq-ARB4aGq!]QBl8$6BmO?+
AU.Wl@<6-mFCfN8A79RgFCfN8+Cno&@3B0#EZccLEbTE5F(or3CLqc?E,oZ1FE;/BATMs%@VfUc
Df'H9FCfM9E,oZ1F<GX=H=_.?FCAWpATD?tAU/K<Eb'3%D/XT/+DYP6GAhM4+D,Y4D'3;(@r*9'
AU/K<Eb$;6FE2)5B6,1I+EM+*+Dbt6B-:`'@s)X"DKILPD09K1EbTE5F(or3F(9-*E-686+DbJ,
B4Z.++E2@8DKI"BBmO>5AoD]4B5)O#DBNJ/Ble35FDu87DKKr6H=_/=DfTqBE,oZ1F<GX=H=_.?
@<3Q"F(8d!A8,po+E_R9EHPh8;eU)iF<GfN9Q+f]/-                                ~>
)
showpass 0 8 put ". ".'zz_',SOLOCALE,'_' [ cocurrent 'base' NB.{*JOD*}
".soclear NB.{*JOD*}

cocurrent SO__JODobj NB.{*JOD*}
zz=:dec85__MK__JODobj 0 : 0
3?U%!1*AS"2)[41ASYk&GAhM4.WT*9AU/K<Eb$;9/M/)cASl@/AKYc"H$=1IA0>K)Df$V+Ch%9(
CLqd8DfTA2F*)G:DJ+#C%13OO<+oue+Eh=:@NZe6ASl@/ATJt:@rH7,BkM@,F!)T7Cgh3s+D,Y*
AKZ&:@WQX3Bl7Q++DYP6GAhM4Et&IuBOQ!*+CoC5DJsV>@rH7,@;0U%-T`[uAo_g,+CQB8@VfOj
+E(j7CLqd8DfTA2F*)G:DJ+#C+B3#c%170%DKK<3+E(j7CLqd8DfTB0+<YB>+E):7ASuU$A0>u4
G@>N&+<Yc>AKW+:FE2)5B6,29ATW'8DIm>f$>+<sD'3q6AKXogF_=EkB-:)@;cFl*:e<8K$4R>c
ATD6gFD5SQ%13OO+<XEG/g+_ME,95uBlkJ.AS,XoBln'-D@Hpq+ED%/AU/K<Eb%<o+>GYp3Zodu
1+%E%5W^DA/j:C+-mpB(+=AN`/1D]83Zp+*+=K?6/mg=[/j:C*-T`\'+=nil4s5+n/M8A&4s24#
+=ANc+>#2m/j:C?4Er4_$4R>QH!t5E+<Y-0@r*8N/g+Y?+ED%/AU/K<Eb$;%Ch%8j$4R=b+DYP6
F$2,u-Za3E4!80IDffE#B4YU8+CT+K+DE2b-Z*EV+D58(FCAfpARmkF@Vg0u?Y!ScCHEXmH8.K(
FDl(F%144#-YI"/FCAfpARm/2Eb0#tH$=1IA0>Z!H#jE%%13OO%13                     ~>
)
showpass 0 9 put ". ".'zz_',SOLOCALE,'_' [ cocurrent 'base' NB.{*JOD*}
".soclear NB.{*JOD*}

cocurrent SO__JODobj NB.{*JOD*}
zz=:dec85__MK__JODobj 0 : 0
0fU:2+>P&o0d&8.3$9t1+>G],1h(TACh.BsEcQ)=:-pQ_@WcC$A8Q%$Ec5t@F=f'e@WcC$A0<9p
Bl\64E`d?nAgnj2DIal#BleB:Bju4,AM+E!:-pQB$;No?+CfG'@<?'k3Zp130fWojCb[[S$;No?
+Cf(nDJ*O%3Zp"+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+
/M/O`$4R>+0RI_K+?MV3F)?&4E-ZP:EZfLHBl%i<+BosE+E(d5-RT?14tq>#Bl\64E]H-?Anc'm
4ZX^&Ci^^H9keWgDfSs#AS*;!$8EZ-+=M8A@:UKBHTH"XEcQ)=3B9*3Bl%?0+Eqj?FCcRB@lc8a
D09K.Bl\64E\CsA@s)X"DKKqQG]IA-A7@2dBl\64E`d?nAhIe4F!hD(1a+n;2'>"/D/"$2DfRiu
3G)uAAL@oo%17&pBl8$6BmO?+AU.Wl@<6-m0JH6g/h1g\Bl8$6BmO?+AU.Wl@<6-m0JFVj/M/)S
@<6-m+EV19FE8R:DfQsKE,oZ1FE;/BASYk&.4u&::-pQB$;No?+Eh=:@UX@mD)reJF)uJ@ATJtB
E,oZ1FE;/BASYk&.3N&:A0>DoE+NotASuU2+Dbt)A7]9oBl8$2+C\c#AKYf-@ps1b/e&._67r]S
:-pQU+<Y<.FE2UK4$"a.EbTE5F(or3CLqc6E,oZ1FE;/BASYk&?XdGbBk)6rF*(r$FC?O>%15is
/e&._67sBjEb/[$ARmhE1,(FBC12!70F\@a67sB4/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+
/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/I`%^67sB83,2l>
0f'qaBl7?q+E1b1F(Jl)D.Rd0@:s-o@:Wn[A.8l@67sB83,2l>0f1"jDffP5F`V+:De:+?;b^7^
:g$ad;H$.j78kWX@X0(EE,oZ1FE;/BASYk&.1HUn$;No?+DG_:@;KXg+DG\$B4W2rBl.F!F(oQ1
Et&IqF*'Q++E2@8DKKr6H=^l'H!b#hF(o-+ATMs(@<>oe$4R>;67sB7+E2%>AS`K"Bl.F!F(oQ1
Et&IqF*'*!3Zoh5-SQns+=K?#I4f4d+<tiHF=B:++>PBo+E2CD%13OO:-pQUFD,]5GB4m8F)to5
FD5Z2+>"^YF(KD8-rWi?7o3>f78d&U>")@=%14M&EbTE5F(or3CLqc63]\B<3[l1jF*')F$4R>;
67sBuAS5FnBm+&1E+sQ.C`m8&D.RU+Bl@m1%17&qF>,j=+=K?"/Mf(..3L$$."*^^/g)BXF*&im
0d&5#I3<KMF:AQd$;No?+EV:;Dg-7F@<6L$Ecc#6D@Hq$E,oZ1FE;/BASYk&+?DP+0fga+E-$+T
%13OO:-pQUDJsV>ASuF/B4rE,Bm=3*Et&IqF*'*!3Zoh5-S[;&.3L$$."*^^/g)BXF*&im0d&5#
I3<KMF:AR*F#lEY:JaVb78-WQ79M&^4WlI%HQ[9JBl8$6BmO?+AU,D;F*')F$4R>;67sC$@<?4%
F!,@=F<G:8+E2@8DKI"BBmO>5FCAWpAISucF*'*!3Zoh5-SdA00IJ:l-p/o+/nlp\,B.^G.6B75
I3<KMF:ARrF*'*!3Zoh5-T<_50IJ:l-p/o+/nlp\,B.^G.6B:6I3<KMF>+.2.!%F3:/=bR<(TkY
79M&^4WlI%HQ[9JBl8$6BmO?+AU,D;F*')F$4R>;67sC$ATW'8DBNe)G\M#;D'3n6H=\42DfQt/
Cht57@<?4%Et&IO67sC)BOu'(D/XH++EV:*DBNM.Dfo]++E2%>AScDs$?L914ZX^43[-:$;b^7^
5uUTK6W?rZ<DGq)E,oZ1FE;/BATMs%@VfTu;b^7^:g$ad;H$.j78jX&Bl.BpD0%j$+<iin/j:C?
+tt-'/i#+70Ie8!-9`f%+=ALGBOPq&F^c[M4s2^*F#kFj/g`b)F)uF4$4R>;67sBsDdd0!Cgh?s
AKY](@:s-oA8,mlDKBN1DK?6oE-$+T4ZX]6-p0O8E-$+M+=&(DD.I?tF"&4[4=GV1BeCWLF*&im
0d&5#I3<KMF:ARdBkML$H=_.\3ZoOn4?=^+F*&iR,TqFp-9`PnF*%iu@VKIrBmO?3+?^i%+F>5M
EbTE5F(or3CLqc6E-$+T%13OO%14gN5U\?13\i$;.3L!HCht59ATMs7+E1b1F(Jl0%13      ~>
)
showpass 1 put ". ".'zz_',SOLOCALE,'_' [ cocurrent 'base' NB.{*JOD*}
".soclear NB.{*JOD*}

cocurrent SO__JODobj NB.{*JOD*}
zz=:dec85__MK__JODobj 0 : 0
0f:(/+>P&o0d&8.+>PVn1GE9\Bl%<sBl\64Eaj0*Ch+Y:9keWgDfSs#AS*A6@;]TuA8-+,EbT!*
FCfE3Bl8$6BmO?+AU.Wl@<6-m0JHsEF(o,,FCfN8F!,(5EZccLEbTE5F(or3CLqc?         ~>
)
showpass 1 8 put ". ".'zz_',SOLOCALE,'_' [ cocurrent 'base' NB.{*JOD*}
".soclear NB.{*JOD*}

cocurrent SO__JODobj NB.{*JOD*}
zz=:dec85__MK__JODobj 0 : 0
2`;d<+>Y,q1a"Or3&33E+>Gbs1*A;11,pC22'=Xs0fM!53?U("0fLjH+>G\q1*AP90d&J!1*AM2
2BX_0+>P&s0K:102]sju3&WQYA867.F@:%aBl7?sF@0t_DfTo+FEhm_2(L71/M/P)/M/P+/M/P+
/M/P+/M/P+/M/P+/M/P)/M/P+/M/P+/LrD)/M/P+/M/P+/LrD)/M/P+/M/P+/LrD)/M/P+/Lq0U
@rHL-FF7S:Ci=>:CLqc6+<VdL+<VdL+<VdL+FIdAAT;j(DI[s>E+O'"ASuT4+<VeS@s)X*F_kK.
Bm+'8Eb0E*EcYf>$7d\[/M/P)/M/P+/M/P+/M/P+/M/P+/M/P+/M/P)/M/P+/M/P+/LrD)/M/P+
/M/P+/LrD)/M/P+/M/P+/LrD)/M/P+/Lq0U+<WB]+FIQN?Y!ScCNF<#FCf**AU,C@+<VdL+FH")
0H_J\+<VeS+<WBn/hf1<1bpt:0ek:72DI$D2BX,i1bpmJ+<VeS$@Es=1*@]e?nbqsCgggh+<VdL
+<VdL+<VdL+<VeS1H%'4+<VdL+FG:S3%d'H2E*BG2LI5>/iGIE0f1j4+FGt(2`W!'+FFND+<WH_
+FIQN?Y!kfB6%R/+<VdL+<VdL+<VdL+FGq&2BX+b+<VeS+<WQp1,^gA3AraB1,U[D3&i`O1a!og
1GggD+<VeS$@Es=1a!og?nbqu@<--rEb0M=+<VdL+<VdL+<VeS1,CU,+<VdL+FG:S2(g^?1GCUE
1jh)6/i,191cR96+FGt"1cZ[$+FFND+<WNa+FIQN?Y<e]DKB9*Ec3'C+<VdL+<VdL+FGpu0H_J\
+<VeS+<WKn2_[-M3&s!H1H$j>0K:mJ1E[ff1-%'L+<VeS$@Es=2BX,i?nbr#Eb0M=+<VdL+<VdL
+<VdL+<VeS0f_08+<VdL+FG:S+>b]/1H%$K21.57/iGOC3&NZ<+FGq'0f^@!+FFND+<WTc+FIQN
?Y!ScCN"$'G%G<,AS#a%+<VdL+FGn'3$9=d+<VeS+<WKn1bpmF2_[+:1c6m>2E<TL3$9>k1,UgB
+<VeS$@Es=3$9>k?nbr(BkM+$B6%R/+<VdL+<VdL+<VeS0fV'6+<VdL+FG:S1bLRC2`39C2LI>A
/i5CC3ANT;+FGq#1Gg3s+FFND+<WZe+FIQN?ZL(+H"(f4GA\NG+<VdL+<VdL+FGn'1E[e_+<VeS
+<WKn1GC^H3AiaC2)?jD2)@3I1a!og1,1UF+<VeS$@EsN0H_Kc?nbr(BkM+$F*(u)Cgq4'AKW*<
+<VeS0fUp2+<VdL+FG:S1bLOC1G^pC3.*SC/hf(?0fV$5+FGn(2DlU"+FFND+>GSn+FIQN?ZU=#
ASbglF_)[<+<VdL+<VdL+FGn$3?TFe+<VeS+<Vd_/iPUB0Jte:2DHgC2`WWM1*@]e0fM'J+<VeS
$@EsN1*@]e?nbr/Bl%s(EZcJI+<VdL+<VdL+<VeS0ekR/+<VdL+FG:S1+kLA0JG@@0mkl9/i>=C
1-%68+FGn%1,L*r+FFND+>GYp+FIQN?Yj.oASu$iEZcJI+<VdL+<VdL+FGmu0H_J\+<VeS+<WEl
2)mQT1c.%:2E*6B3B/`M0d%Td0f:XE+<VeS$@EsN1a!og?nbr0@;[21+<VdL+<VdL+<VdL+<VeS
0ek@)+<VdL+FG:S1+kFD3&i`O1jh2A/iG[I3B/l=+FGn"3B/-(+FFND+>G_r+FIQN?YjFhBQS<3
@<?'nEb0M=+<VdL+FG:j3?TFe+<VeS+<Vd]/iY^K1,^k72_cpB1c@*G2BX,i0et^J+<VeS$@EsN
2BX,i?nbqtDfT`-Ci=N/Eaij-AKW*<+<VeS+?))!+<VdL+FG:S0ePC>3&!3E1OM,;/i#=A1-%99
+FGn!0KC6u+FFND+>Get+FIQN?[$0tFCfN1Deio,+<VdL+<VdL+FG:i3?TFe+<VeS+<WBk2DR'K
0ekP52`*-H3&iZI3?TGl0ekIB+<VeS$@EsN3$9>k?nbr/@:WnbAR][uGA\NG+<VdL+<VeS+>u"u
+<VdL+FG:S0eP:B1,gmA3.*YC/i,F?3AE62+FGmt2E)a$+FFND+>Gl!+FIQN?ZTpmDJil*+<VdL
+<VdL+<VdL+FG:h3$9=d+<VeS+<WBk1H%*E1,gq82`E?J1Gq0K3$9>k0eb:<+<VeS$@EsO0H_Kc
?nbr/CO'B*F_)[<+<VdL+<VdL+<VeS+>kqt+<VdL+FG:S0eP4<2`!<H1OL<(3%d3N1GUs5+FG:l
1c?I!+FFND+>PYo+FIQN?Z9RsFW_eL+<VdL+<VdL+<VdL+FG:h0H_J\+<VeS+<WBk0fM!L1cI:>
3%us>2D?g@3$9>k+?2A;+<VeS$@EsO1*@]e?nbr)Bk2*qB4uBrCis;3+<VdL+<VeS+>c)$+<VdL
+FG:S0eP1<1GU[?21-N+0eP7:1GUg1+FG:k1c$6s+FFND+>P_q+FIQN?YjFoASrV5+<VdL+<VdL
+<VdL+FG:g1a!n`+<VeS+<WBk0JbRD1H.:@3&3*B1cRER3$9>k+?);;+<VeS$@EsO1a!og?nbr(
BkM+$@Vg0u+<VdL+<VdL+<VeS+>bnt+<VdL+FG:S0eP.92)R0K3.*\A/i,ID1GUj2+FG:j2)$-q
+FFND+>Pes+FIQN?Z0apG%G3)@:C?%+<VdL+<VdL+FG:g0H_J\+<VeS+>>E.1bgdH2`WjF3&E6D
1,V!G1a!og+?(u4+<VeS$@EsO2BX,i?nbr3BOtUo+<VdL+<VdL+<VdL+<VeS+>Z##+<VdL+FG:c
/ibXF3&WQH1OM/>/i#7>2)mN;+FG:i2Du[#+FFND+>Pku+FIQN?Y!ScCMRTlCM=n6+<VdL+<VdL
+FG:f3$9=d+<VeS+>>E-3A`NI3&!=>3&WBD1H.<K2'=#h+>tu6+<VeS$@EsO3$9>k?nbr/CghEs
B6%R/+<VdL+<VdL+<VeS+>Yu"+<VdL+FG:c/iYjJ1GUpD3.*\E/hf(:1,Ld0+FG:h3&r*(+FFND
+>Pr"+FIQN?Xe.uCjC5CDe't5+<VdL+<VdL+FG:f2]s4c+<VeS+>>E-2_[0N1GL\53&`HM0JbC=
2BX,i+>l#2+<VeS$@EsP0H_Kc?nbr3BPDR"+<VdL+<VdL+<VdL+<VeS+>Yhs+<VdL+FG:c/iYO=
0fV-J3.*\F/iPI?1,:[/+FG:h0f1!q+FFND+>Y_p+FIQN?ZU+'G9A"N+<VdL+<VdL+<VdL+FG:e
3?TFe+<VeS+>>E+3&3?G1Gpt93&rTI3&NWN3$9>k+>c&3+<VeS$@EsP1*@]e?nbqu@<-.)CghEs
@Vg0u+<VdL+<VeS+>Pht+<VdL+FG:c/iGF=3A<EN3.*\G/ibpN2Dd?8+FG:g2)-3r+FFND+>Yer
+FIQN?XmMTATVBtF_)[<+<VdL+<VdL+FG:e2'="a+<VeS+>>E*3&i]Q1H.+;+?;,.2)mKJ1*@]e
+>bi2+<VeS$@EsP1a!og?nbr)@<-:)DBL&E+<VdL+<VdL+<VeS+>P_q+<VdL+FG:c/i>I?1GCUE
1jh;</ho+?1GUd0+FG:g0JFUl+FFND+>Ykt+FIQN?Z9q-A7]djCis;3+<VdL+<VdL+FG:e1E[e_
+<VeS+>>E*1bgd?1H74=3AE-E2E3TM3$9>k+>Yr8+<VeS$@EsP2BX,i?nbqrDKKT4F_,c1Blmo/
+<VdL+<VeS+>PVn+<VdL+FG:c/i5L@2E<`W3IEhB/ho.B1GUm3+FG:f2)HEu+FFND+>Yr!+FIQN
?YOCgBjkn"ARlo++<VdL+<VdL+FG:d2]s4c+<VeS+>>E)0JG1@1bgh73AN3E1H@9I0d%Td+>Yf1
+<VeS$@EsP3$9>k?nbr"Bl[coEbT$!+<VdL+<VdL+<VeS+>G_r+<VdL+FG:c/i,@@0JYI?1jh;=
/iYjH1c.'4+FG:f0fL3t+FFND+>Z##+FIQN?YjFhBQS<2H"(T4AKW*<+<VdL+FG:d1a!n`+<VeS
+>>E(1-%0N3ANUB3AW9C1,1dF2'=#h+>Y],+<VeS$@EsQ0H_Kc?nbqu@<-.)ART4lAS#a%+<VdL
+<VeS+>G\q+<VdL+FG:c/i,7C1cRKN3IEhC/i>L@1bpm1+FG:e3&i$'+FFND+>beq+FIQN?ZTXn
A9hX)Dg-(A+<VdL+<VdL+FG:d1a!n`+<VeS+>>E(1-%0N3ANUB3AW9I3&!?I1E[ff+>Pl4+<VeS
$@EsQ1*@]e?nbqsBle9:AKW*<+<VdL+<VdL+<VeS+>GSn+<VdL+FG:c/i#:D3&i`O1jh;?/ho.B
2`Wi?+FG:e2D?6r+FFND+>bks+FIQN?Y=:nA7]Y!De't5+<VdL+<VdL+FG:d0d%S]+<VeS+>>E'
2)mQT1c.%:3A`?E3B/oV1*@]e+>Pc6+<VeS$@EsQ1a!og?nbr0ARTBt+<VdL+<VdL+<VdL+<VeS
+>GPm+<VdL+FG:c/i#4?1Gh*K3IEhD/iGLB0JbI,+FG:e1H6L"+FFND+>bqu+FIQN?Y=%jF*)V>
Blmo/+<VdL+<VdL+FG:d0H_J\+<VeS+>>E'1GpsF3A`aD3A`?J2E<QQ0d%Td+>P]3+<VeS$@EsQ
2BX,i?nbqsEc6/>+<VdL+<VdL+<VdL+<VeS+<WZe+<VdL+FG:c/i#.93&*6I1jh;@/hf7>0f_-7
+FG:e0fU9u+FFND+>c#"+FIQN?Z]sqF*)50+<VdL+<VdL+<VdL+FG:S3?TFe+<VeS+>>E'0ekXB
1c7+;+?;;31-%-E0d%Td+>PW2+<VeS$@EsQ3$9>k?nbqsASGdg+<VdL+<VdL+<VdL+<VeS+<WWd
+<VdL+FG:S0J5(>3&3EQ2LHW-2(g^F0eta3+FG:e0JFUl+FFND+>c)$+FIQN?Xn+jD0'W5+<VdL
+<VdL+<VdL+FG:S3$9=d+<VeS+<W?j0fV-J2`WdD3AiEI2E<WQ3?TGl+>Gl3+<VeS$@EsR0H_Kc
?nbr.Dg>c-@Vg0u+<VdL+<VdL+<VeS+<WWd+<VdL+FG:S0J5(>3&3EQ2LIMB/iY^I3&EW<+FG:d
3&Da#+FFND+>kkr+FIQN?Z0snDJ*O$ARlo++<VdL+<VdL+FG:S3$9=d+<VeS+<W?j0fV-J2`WdD
3ArKD1c@'D3?TGl+>Gf5+<VeS$@EsR1*@]e?nbqtBQ%C!CghEs+<VdL+<VdL+<VeS+<WWd+<VdL
+FG:S0J5(>3&3EQ2LIMC/i#4>1b^m3+FG:d2E2g%+FFND+>kqt+FIQN?Z0akCgggb+<VdL+<VdL
+<VdL+FG:S2]s4c+<VeS+>>E&2Dd?L1c@4=3ArKG3B8fO1E[ff+>Gc.+<VeS$@EsR1a!og?nbqu
AS#h%CO'B*F_)[<+<VdL+<VeS+<WTc+<VdL+FG:c/ho7@2`*?L21.DB/i>OC3&ro?+FG:d2)??t
+FFND+>l#!+FIQN?Z9FiAS5ptA7]Y!De't5+<VdL+FG:S2BX+b+<VeS+<W?j0f1U?0KD(>3ArKK
0JtR=2]s5j+>G]2+<VeS$@EsR2BX,i?nbr#Derr,+<VdL+<VdL+<VdL+<VeS+<WQb+<VdL+FG:S
0J5(:0etFC2gdVD/iY[G1GLg2+FG:d1b^$p+FFND+>l)#+FIQN?Z0apG%Dd=+<VdL+<VdL+<VdL
+FG:S2BX+b+<VeS+<W?j0f1U?0KD(>3ArKM3&`]M2BX,i+>GZ/+<VeS$@EsR3$9>k?nbqu@<--r
Eb/g"+<VdL+<VdL+<VeS+<WQb+<VdL+FG:S0J5(:0etFC2gdVE/ho+@2`!?7+FG:d1,pC!+FFND
+>l/%+FIQN?Y!ScCNEp#D/X;7+<VdL+<VdL+FG:S2BX+b+<VeS+<W?j0f1U?0KD(>3B&QG2E<cS
2BX,i+>GW,+<VeS$@EsS0H_Kc?nbr,@;KLsF`MJEDeX9(+<VdL+<VeS+<WNa+<VdL+FG:c/ho(>
2E*HO21.DC/i,IG2DR!0+FG:d0fC-s+FFND+>tqs+FIQN?Y!ScCM.R%A7]Y!De't5+<VdL+FG:S
2'="a+<VeS+>>E&0fM!L1cI:>3B&QJ0JtUG2'=#h+>GT*+<VeS$@EsS1*@]e?nbqu@<--nH!tS5
+<VdL+<VdL+<VeS+<WNa+<VdL+FG:c/ho(>2E*HO21-N,2_I!D1-%99+FG:d0K($r+FFND+>u"u
+FIQN?ZTdeB6%QpDBL&E+<VdL+<VdL+FG:S2'="a+<VeS+>>E&0fM!L1cI:>3B&QL1b^gE2'=#h
+>GQ)+<VeS$@EsS1a!og?nbqrCh[Bj@Vg0u+<VdL+<VdL+<VeS+<WNa+<VdL+FG:c/ho(>2E*HO
21-N,2_I'I3&<<4+FG:S3Ar!&+FFND+>u)"+FIQN?Z':q@;9_)BPDR"+<VdL+<VdL+FG:S1a!n`
+<VeS0J5%>1bgdH2`WjF3B&QN2)7!G3?TGl+<W[!+<VeS$@EsS2BX,i?nbr(BkM+$@sML#+<VdL
+<VdL+<VeS+<WK`+<VdL+FGjq0KCsE1H@BS3.*_G/hf+?2*!Z>+FG:S3&_s&+FFND+>u/$+FIQN
?Z^4'@<?E1+<VdL+<VdL+<VdL+FG:S1a!n`+<VeS0J5%>1bgdH2`WjF3B/WG1b^jE3?TGl+<WX"
+<VeS$@EsS3$9>k?nbr)Bl8$&Eb/Zr+<VdL+<VdL+<VeS+<WK`+<VdL+FGjq0KCsE1H@BS3.*_G
/i#4>3&`i?+FG:S2`W!'+FFND+>u5&+FIQN?Y"(cB4Z*mCis;3+<VdL+<VdL+FG:S1a!n`+<VeS
0J5%>1bgdH2`WjF3B/WI1-%$C3?TGl+<WU#+<VeS$@EsT0H_Kc?nbr(BkM+$B5_TsASuO,A9ha&
Ci=NF+<WH_+<VdL+FGjq0K1[D0JkaG3.*_G/i,LJ2DR'2+FG:S2_cEt+FFND+?)"t+FIQN?Y!Sc
CN<us+<VdL+<VdL+<VdL+FG:S1E[e_+<VeS0J5%<0K(UA3&EUB3B/WJ2_[!B3$9>k+<WR%+<VeS
$@EsT1*@]e?nbr,Bl7]/+<VdL+<VdL+<VdL+<VeS+<WH_+<VdL+FGjq0K1[D0JkaG3.*_G/i>I>
3&<?5+FG:S2DlU"+FFND+?))!+FIQN?Y4+mEa`d.BPDR"+<VdL+<VdL+FG:S1E[e_+<VeS0J5%<
0K(UA3&EUB3B/WL0ekL@3$9>k+<WQt+<VeS$@EsT1a!og?nbr(BkM+$E+s3*+<VdL+<VdL+<VeS
+<WH_+<VdL+FGjq0K1[D0JkaG3.*_G/iG[E0JkR.+FG:S2)ud%+FFND+?)/#+FIQN?Y!ScCN"6%
DJ*N'+<VdL+<VdL+FG:S1E[e_+<VeS0J5%<0K(UA3&EUB3B/WM2)7'H3$9>k+<WO"+<VeS$@EsT
2BX,i?nbr)BleBAEc6#1+<VdL+<VdL+<VeS+<WH_+<VdL+FGjq0K1[D0JkaG3.*_G/iYUB1,Uj1
+FG:S2)??t+FFND+?)5%+FIQN?Ya=`CM=n6+<VdL+<VdL+<VdL+FG:S1E[e_+<VeS0J5%<0K(UA
3&EUB3B/WN3AWWP2]s5j+<WNq+<VeS$@EsT3$9>k?nbquAS#h"Bl7]/+<VdL+<VdL+<VeS+<WH_
+<VdL+FGjq0K1[D0JkaG3.*_G/ibgH1c@*3+FG:S1cHO"+FFND+?);'+FIQN?Z9FiAThd+Ch7^/
ARlo++<VdL+FG:S1E[e_+<VeS0J5%<0K(UA3&EUB3B8]G1GpjE2]s5j+<WKt+<VeS$@EsU0H_Kc
?nbr/ARTXnASc0*+<VdL+<VdL+<VeS+<WH_+<VdL+FGjq0K1[D0JkaG3.*_H/ho%;2E*B6+FG:S
1bg*q+FFND+?2(u+FIQN?ZK^g+<VdL+<VdL+<VdL+<VdL+FG:S1*@\^+<VeS0J5%92_[-M3&s!H
3B8]H2)7*I1*@]e+<WI"+<VeS$@EsU1*@]e?nbr)ARoLtD00o@EHQ26F(HI:+<VeS+<WE^+<VdL
+FGjq0Jk^B2E<`W3IEhI/ho@H3&*02+FG:S1H$?u+FFND+?2/"+FIQN?Ys@bBm"93F`MG;AKW*<
+<VdL+FG:S1*@\^+<VeS0J5%92_[-M3&s!H3B8]I1c@<Q1*@]e+<WHs+<VeS$@EsU1a!og?nbr,
CisS;+<VdL+<VdL+<VdL+<VeS+<WE^+<VdL+FGjq0Jk^B2E<`W3IEhI/i#FC3AiQ7+FG:S1GU'q
+FFND+?25$+FIQN?Y!ScCLV+&AKW*<+<VdL+<VdL+FG:S1*@\^+<VeS0J5%92_[-M3&s!H3B8]J
1bg[>0d%Td+<WHo+<VeS$@EsU2BX,i?nbr+EarcsA0<!;+<VdL+<VdL+<VeS+<WE^+<VdL+FGjq
0Jk^B2E<`W3IEhI/i,IH0KCj1+FG:S1,pC!+FFND+?2;&+FIQN?Ys@bBm"9%Cis;3+<VdL+<VdL
+FG:S1*@\^+<VeS0J5%92_[-M3&s!H3B8]K1GpmF0d%Td+<WEt+<VeS$@EsU3$9>k?nbr)ARoLt
D0'8sB6%QpDBL&E+<VeS+<WE^+<VdL+FGjq0Jk^B2E<`W3IEhI/i5OC1,CX-+FG:S1,L*r+FFND
+?2A(+FIQN?YjFhBQSN2Ci"$6+<VdL+<VdL+FG:S1*@\^+<VeS0J5%92_[-M3&s!H3B8]L1-%-E
0d%Td+<WEp+<VeS$@EsV0H_Kc?nbqu@<-.*F`MJEDeX9(+<VdL+<VeS+<WE^+<VdL+FGjq0Jk^B
2E<`W3IEhI/i>RG1H.$2+FG:S1,'gn+FFND+?;/!+FIQN?Z0snDJ*N'+<VdL+<VdL+<VdL+FG:S
1*@\^+<VeS0J5%92_[-M3&s!H3B8]M1,CaD0d%Td+<WBu+<VeS$@EsV1*@]e?nbr5ASc1$G9A"N
+<VdL+<VdL+<VeS+<WB]+<VdL+FGjq0JYFA1Gh*K3IEhI/iGOE3B&i=+FG:S0fC-s+FFND+?;5#
+FIQN?Ys@bBm"92EarcsA0<!;+<VdL+FG:S0d%S]+<VeS0J5%71GpsF3A`aD3B8]M2_[*D0d%Td
+<WBr+<VeS$@EsV1a!og?nbqtDfT`:Bl%Q-+<VdL+<VdL+<VeS+<WB]+<VdL+FGjq0JYFA1Gh*K
3IEhI/iG^H0Jk[1+FG:S0f1!q+FFND+?;;%+FIQN?[64!Ci=N1Eb/g"+<VdL+<VdL+FG:S0d%S]
+<VeS0J5%71GpsF3A`aD3B8]N0fLsL0d%Td+<WBp+<VeS$@EsV2BX,i?nbr)ARoLtD..F,@;TFn
Bl7K)+<VeS+<WB]+<VdL+FGjq0JYFA1Gh*K3IEhI/iPUA0ekR/+FG:S0esjo+FFND+?;A'+FIQN
?Y!ScCMdKmASuTu+<VdL+<VdL+FG:S0d%S]+<VeS0J5%71GpsF3A`aD3B8]N2Dd<L0d%Td+<WBn
+<VeS$@EsV3$9>k?nbr$Dffr4DJL@;+<VdL+<VdL+<VeS+<WB]+<VdL+FGjq0JYFA1Gh*K3IEhI
/iPaL0fV$5+FG:S0ea^m+FFND+?;G)+FIQN?Xdh[DI[?kA79:kDf0).+<VdL+FG:S0d%S]+<VeS
0J5%71GpsF3A`aD+?;G73&*-H1*@]e+<Vde+<VeS$@FQ^0H_Kc?nbr)De!9cF(oM7+<VdL+<VdL
+<VeS+<WB]+<VdL+FGjq0JYFA1Gh*K3IEhI/iYXE1,Up3+FG:S+?1Jd+FFND0eb=)+FIQN?YjFn
AS6$pASrV5+<VdL+<VdL+FG:S0d%S]+<VeS0J5%71GpsF3A`aD+?;G73&NZS3?TGl+<Vdc+<VeS
$@FQ^1*@]e?nbr(@<Q4"A7]djCisf4+<VdL+<VeS+<WB]+<VdL+FGjq0JYFA1Gh*K3IEhI/iYgG
1GUg1+FG:S+>t>b+FFND0ebC++FIQN?XdhoAKW*<+<VdL+<VdL+<VdL+FG:S0d%S]+<VeS0J5%7
1GpsF3A`aD+?;G73A<<M2BX,i+<Vda+<VeS$@FQ^1a!og?nbr(BkM+$F(JcmEb/g"+<VdL+<VeS
+<WB]+<VdL+FGjq0JYFA1Gh*K3IEhI/ib[I1H@<8+FG:S+>b2`+FFND0ebI-+FIQN?Z':qGp"4P
+<VdL+<VdL+<VdL+FG:S0d%S]+<VeS0J5%71GpsF3A`aD+?;G73AiQP1E[ff+<Vd_+<VeS$@FQ^
2BX,i?nbr/CghEs@Vg0u+<VdL+<VdL+<VeS+<WB]+<VdL+FGjq0JYFA1Gh*K3IEhI/ibjK1c@36
+FG:S+>P&^+FFND0ebO/+FIQN?Y44sATMs+Eb/g"+<VdL+<VdL+FG:S0d%S]+<VeS0J5%71GpsF
3A`aD+<VdL+<WBm0H_Kc+<Vd]+<VeS$7d\[/M/P)/M/P+/M/P+/M/P+/M/P+/M/P+/M/P)/M/P+
/M/P+/LrD)/M/P+/M/P+/LrD)/M/P+/M/P+/LrD)/M/P+/Ls2/ART[l9keWgDfT3+EGRBf@rc-h
FCcS:@:F%a+A?]`@;JbKFD)*j+<W(+De!3l:gnHZ8OO\8DKKH&ATAo2Dfd+>F_kk:E,oZ0@<-W9
CLqcB%144#+A?]`@;JbKFD)e=AU&;>DJsV>DKTc3.6@tG%16TcART[l+EV%$Ch4_bDJX$)AP6T[
GAhM4%144#-qe,sGAhM4+EV1>F<GI>F<GIDCht55EbTB!Ed8dCAU,g9$6UH694`B<Eb065ASu"'
+DG_8AS5Rp+Du+>+Du=<CahFT$6UH6%16TcART[l+EV%$Ch4_TCgqO(%144#-p_ZYF_sc_Gp%3?
G]Y'GDfd+>F_kk:E,oZ0@<-W9CLqcB%144#+A?]`@;JbKFD+66+DG_8AS5Rp+Du+>+Du=<Cb-#&
+<Ve#De!3l:i^,gASuT4Bl8$(B4Z*+@q]F`CFDkp@ps1MEb0<'DKJ$)0Hb:S+A?]`@;Jb\ATMF#
F?McA.4bo8+<Ve#@<6NjE+EC!ARloo@<?'3%144#+@0gQF_sl^D.Oi3AU&;J%144#+@0gQF_sNX
F(96)E-,f4DBO%4G]YJG$6UH6AoD^$BkM<+CLqc>9Q+ELCf"P^BLtT@+ED%*ATD@"@qB^(9Q+EL
Ch6FOFD*'rDe!3l:gnHZ8OP!V3t2N+$=e*f@<?''FCAWpAKXcdCh[cu8SqmKAISth+=Kfu@:s.E
AU,D?AU&;>DJsV>DKTc3+E2@8D..I1+DYP6/.Dq/+<XHtCh[cu8SqmKAO^BMAKZ)+G]YJG$6UH6
6#pIKBm+&u9ggi]FCf]=/.Dq/+<Wsj@q]S"ARn_RH=\45DKKH&ATB=2$6UH69OW$WFEM,*+D,G.
@<=%0$6UH69Q+f]BlnK.AKYT$Ddd`=%144#+@0gcBlnK.AKY])FCf)rE\%Y,+<Ve&EbT0#DII?P
ASGdjF<G:8FCf)rE\%Y,+<Ve&EbT0#DII?_Bk2=!+DG_8AS5Rp/.Dq/+<XQn@;J>?FCcS*@<?'3
%144#+B<AsDdd0E@<?''A79Rk/.Dq/+<X?dF*(E$A79RkA0>DkFCd!4$6UH6<H;drFCf]=/.Dq/
+<XWsF_tT*@;0OXEblk?AU&;J%144#+A69kGAhM4F!,R9G]YJG$6UH66XaqUBl@l3FCf]=.6@tG
%16TcART[l+EV%$Ch4_\D..'g6#:"QD-1ff$6UH>8SqmKAP6T[+EV1>F<GI>F<GIDChtX3$6UH6
6#:"QD+eGc+EV1>F<GI>F<GIDChtXF%144#+E2@8D..I1+DYP6-qS8aB4X_IGq:((CgqO(94`At
/.Dq/+<Y97Eb/rtDBN_+Gpksp@WcN\AU,^IEb/ioEb0,uATJt[CgqO(-p_ZYF_sc_Gpt9R$6UH6
AoD^$BkM<+CLqc>8SqmKAP6T[.3NYBAn?!oDI[7!+AZlkBl7KRD..'g-qS8aB4X_IGpt1(%13OO
@rc-hFCcS:@:F%a+A$EYB4X_IH$=1IA6<j]$6UH>8SqmKAP6T[+EV1>F<GI>F<GIDChtX3$6UH6
94`BmDfTA2FCf]=+Du+>+Du=<Cb-#&+<VeGEbTB!Ed8dCAU,[qD..'g94`B"+A69kGAhM4.4bo8
+<Ve=DfTE'B5Si-AU,[sAU/K<Eb$UAEb/ioEb0,uATJtiDJX$)AP6T[GAhM4-qe,sGAhM4.4bo8
+<Ve=DfTE'B5Si-AU,[qD..'g94`At+ED%*ATD@"@qB^(:Msu_DIlCV@:s."8SqmKAP6T[.4I=f
$4R>PEb/[$AKZ)'@VfTu9Q+ELCe8JPB4VMZ+<W(+De!3l8SqmKAP#94Bl8$(B4Z*+DJsV>DKTc3
+E2@8D..I1+DYP6+CTD7DeX*!Eb0*!DKIE=$6UH69Q+ELCf"P^BLtT7Bl8$(B4Z*+DJsV>DKTc3
/.Dq/+<X?r@ps1QBQ\0$8OO\8DKKH&ATAo2Dfd+>F_kkF%144#+A?]`@;JMP@:s.@Bl%?'FCf]=
+Du+>+Du=<Cb-#&+<VduD..'g94`AkFCf]=+Du+>+Du=<Cb-#&+<Ve=DfTE'B5Si-AU,[tDe!3l
:gnHZ8OP!MEb/ioEb0,uATJtfDe!3lAPcfWBIHPm@ps1M@<?0S6n'Yr$6UH6AoD^$BkM<+CLqc>
8SqmKAP6T[.3NYBAn?!oDI[7!+AZlkBl7KRD..'g-qS8aB4X_IGpt1(:et"h?VP6TEc5u#Eb/i<
0ht%f:et"h?VP6TEc5u#Eb/i*E,Tf>+E2@>@qB_&DfRHQ%13OOF)>i<FDuAE+>=p!+>=63:-pQU
Bl8$(Eb8`iAKZ28Eb$S>.67nF:-pQU+<X!nBl%<SBl\64EZcK"67sBi@:O(qE%b^AART[l05PQ8
A0>`'EcQ)=%14Nn$4R>PDe!p1Eb0-1+=CW,F(H^.$=e!gDKBB0F<D\R9keWgDfSs#AS*;!$=[Fb
AMZ5OE-X3!+<VdL,9V&EF_>Z=FCfJ8E-ZP=Df-\,@<6!&1H$@c@<6!&D..L$+Cf>#AKWQI8g&=r
Eb'56D09oA+DkP/@qZto$4R=b+<Ve;AS*&p@<6!eD..L$?Y++bDe*E-F(K0"/0K"NF_>&sAU,^c
%144#+<VdL+<VjP+q4l%+<VdL+<VdqDI[TqAKZ).AKYJkF(HJ2@<63,@<3Q"DBNY2FCf)rE\7e.
+<VdL+<VdL+sJ3?$6UH6+<VdL+Dr;b+>=63+<VdL+<VdLAoD]4Be1B:+DG^9ASuX-ATD4$ALMV:
F_>&sAU.K@3\<'l.67nF+<VdL+<VdL+<VdLBkAJt/noBLE,]B/-n.1d$6UH6+<VdL+<VdL+<VdL
+Dr;P4WlL&.OlQT%144#+<VdL+<Y]9FEMVA+EM+1AhIP$F(I-cASu!rA7[0,.1HUn$6UH6+Co%q
+Cei$ARB:_F),,nARfXhALMV2Ch>4@F)?&4?Ya4u/0JG2F(J]q@<6353XlE=+<VdL+<VdN+sII'
+<VdL+<VdL;IsokDfTD3Ch7^1ATAo'@<6!&FDi9MF)?&4?Ya4u.4u&:+<VdL+<VdL+sJ3?$6UH6
+<VdL+<r">Ec5n>-ST!W+C]&&@<-W9E,oN%Bm:'o+<VdL+<VdLD..L$+?^iVBl5>?ASbs2@UX=h
1H&cT@rGmh-t?\,ARB:_F)*3R>;A6F%144#+<VdL+<YB1+DbV,-uEC6CFLAi+DbV,.!'6JB4#Fc
Gptc`$6UH6+<VdL+<VdL+ECn)F(HIp@;L't7<3EeE[VA(+<VdL+<VdL+<VdL+<VdL-Ra%QF_>&s
AU,^ICh7KsFD)e-De3u4DJsV>D..NrBHS^5@<6!eD..L$.3NG<DJ+')-RfK3+<VdL+<VdL,9Ur6
A0>_tF))nBBln#2-SQoh+DGF1DIm<hF)tc1Gmt*'+<VdL+<Ve@Afto$DCB@1F)*3I4<SHODCBRC
F_>&sAU,^c%144#+<VdL+<VdL+<YN0F))m]+=JXSASro;D09JuCLqc?+>"^PASro5@<635.3L)_
-SQns+=eRO@<62n$6UH6+<VdL+DbV2FCfK6+?^i`BleAEF)?&4?Ya4u.1HV,+<VdL+<Ve=DfQt7
/0H?N/0JdY+DG^9ASuX-ATD4$ALMk=E%#O6FED)7F"AGN@<635.67nF+<VdL+<VdL+<VdLBkAJ8
0de),4WnT&%144#+<VdL+<VdL+<VdL+<YK3FED)7F'E?a+?^iW/p2,PATB1J%144#+<VdL+<Y]9
FEMVA+=ANhC2[g(-u<I:FCfK6.1HUn$6UH6+@(!i@<?3nD.Rg&De':a+<VdLA7]?q@UX=h1H&f^
@rGmh-uO0E@V'R/3XlE=+<VdL+<VdN+sII'+<VdL+<VdL7;cURA7Zm&Df]W7Bm+&1Bl8$(B4Z*+
@<3Q"+C\c#AKWce+EMXFBl7Q9%144#+<VdL+<VjP+q4l%+<VdL+<Ve@Aftu0F<G:=Bl8!6@;]Rd
-uO0E@V'R2+DG_8.67nF+<VdL+<VdL+<VdLEa`['AKXrtE+MIYEc5tH-Z4'D@V'R&D09oA+C\n)
@;[3%DKKH&ATB.I%144#+<VdL+<YB1+Du==@V'R&4<Q==%144#+<VdL+<VdL+<Y]5Bldi.<affe
AOUW[DfR6RDKTf*ATAo1F`VXI@V$[$Df]W7Bm+&8.1HV,+<VdL+<Ve8CiF&r@V'X4+C\c#AMZ4e
4WmrV0JP==1c70M3&tDV@q9._B4u!oCM[j*DfB]:F*)PJGBeCZ-S-Af-X@/g+<VdL+<VdLGA(],
AKYl5D.7's3XlE=+<VdL+<VdL+<VeEF_tT!E\&>I+?^iXBm+?3A12><D.7's/0H`,.1HV,+<VdL
+<VdL+<Ve9@<6!92BY.*@;Kmr@:Eei>A7@c.j/;0F(I-c%144#+<VdL+<Y]9FEMVA+C\c#AMZ4e
DfQt/CiF&r@V'Xc0O5+p%144#+<WpjFCB9*@r5e!BQ%Dj$6UH6+Co%q+C\c#AMZ5TARfXhALMG=
D.7's.67nF+<VdL+<VdL+sJ3?$6UH6+<VdL+@KdNDe*E%@UX=h+>YnuF*)G:DJ()#DIal1ATW'8
DBNY2FCf)rE\7e.+<VdL+<VdL+sJ3?$6UH6+<VdL+ED%8F`M@BBl8#@DKTf*ATB=E1H$\!Bl\64
E`I0lE_BthF##UJ67sC'F(KB-AU/>L@qK?_$;No?%15is/g+)(AKZ22CM=o1@:s-oGB\6`C3+<*
FE_/6AM.J2D(fXJBkqE97s/NVATKLlDf00$B.lkSF>$X8ATCFTH#jE%:-pQU@;L"'3Zr*XFDs8o
05>QHAor6*Eb-k5Df%.?Bln0*F*''TFD58s/n\m?04Ja9@P;S,F*(u605P?304J@2AM81IATDQt
H#kTJE,Z6n:-pQB$;No?+@UN`D/a<&F#ja;:-pQU+@\.K0fr*DDImm5AS#glE]\)U@:UK.IUQbt
Df0VLB45XgF"_BEDImm5AS#glE\DQLG@W=?C3(a3$;No?+<X$nEbm6s4"r`dCi=B9@<-WT@WHC2
F(J]n?RKN/FDs8o06_Va/o#HGAor6*Eb-k5Df%.BGA1i,033"$@:F@q@<-WH7r3*bF('*7-OgDX
67r]S:-pQU,"$HmCb%t5+q4lS67sB)6Zd?b.oU+qAooOm2BiS;:-pQU,#`/hAooOm2BiS;:-pQU
,"=L8%15is/g)?*FE21J7Q2M#$;No?+<j0pEbm7)BPD(#.n2HA%15is/g)?:BPD(#.n2HA%13OO
7P[%[4&TX,@;BEs6ZmEiASuTOCi<`m+=BltEcQ)==E7tb-QlV90d(LYF<Dr?F_PZ&D/"$2DfR3J
>9J!,CiX*.ATV9uF)c#1FCef%-RU$@+Cf5!@<*J<-OgDMFE21J7P[%[4&]^4+@C9lEb0-14*#Bb
-ZF*@D/"$2DfR3J>9Iip+=D5IF_>Z=FCfJ?+BosE+E(d5-RT?16Zd?b.oU+qAooOm1-73P7!3?c
+Ad3&4*#Bb-Y.@:E,]rA-OgDP1HR<Q;IsijBl[c-8l%i:Eb065Bl[c--YI".ATD3q05>E9-OgDM
FE21J7Pd+\4&TX"H"1Z%+A,Et4"+i^A8c?./0J\GA8c'l.3L>S$<(VPAooOm1HR<Q8l%ht87cUV
4)/\EBOu"!+>=637Pm1\4%*XhF_;gpF`'9O@WHU/+=ANG$:Zp80fr?GF*&O'D/X3$4'a4/8PN#(
F)>i2AKZ)+F*&c=$<(VPAooOm2ENWT<+U,m+@9LXBk'4P:.\/V+C\c#Bk&9-ATMr@E,o]1Bl\64
E\]@E67sa,Eb]H*EcQ)=+EK+d+EM+9F`8HtBl\64E`d?nAfu&5De`inF=n"0%16T`@s)g4ASuT4
-XpM*AL@oo%16oi@:UK.A79Rg06;,LBlmo6%13OODe'tP3[\ucF_>Z=FCfJ8F`_>6F!i)7+>Y-Y
A0<6I%16igA7o7`C2[Wi4ZX]59keWgDfSs#AS*;!$4R>`A9)$kC2[Wi4ZX]5@lc8aD09K.Bl\64
E\D9DEcQ)=-QjNS+<VdL+<VdL+<VdL+<VdL+<Ve%67sBtBl\64EZen,Eb/a&DfU+4$?L5t?YO7n
A7%J\+=CY[06ClMD.7Qs@WO2AEbTB!Ed9Do0fUe-E+EE;F!i(Q+<VdL+<VdL+AP6U+EV:>D.7R*
CiseAA7>uTFE2#$BkhQs?TgFm-Y#1jF)?&4D/"$2DfRLADe!p,ASuU206hMKAn5@(D/"$2DfRI@
@OE9@:-pQUD/"$2DfQt2@LWYR$;No?+Dbt)A0?#9AS-($+E_d?Ci^_5DKKe>-u!F7A17rp:-pQU
-Y[=6A1&L4ATT&C/g+eIE$-N@Ec>N)@<6L4FD5Q4-OgDX67sB.BkhQs-Qm&5F<Gua+D5_6+=C]/
AU&;E%15is/g)NUC2[W1+D58-+FPjbB6%r6-Y-e4BPDR"C3*m*BlJ/A%14IsC2[W1+D58-Ed/]g
3[]#j+D,8,+DGFt-Qij*:-pQUF(KG9F)?&=H$!V<+E_a:EZf./H#jE%F)>i<FDuAE+=D;QATCFT
H#k*KATMF)-OgD2FDj]G;cFl$+F?-l/0HYiE+rft+>b3RATT%BD/"$2DfSj!ATCFTH#k>^+Eqj?
FCcS0E+*j%+=DVJDf00$B.nCKATDQtH#kTJAnNJ6%17/nDfp/@F`\`R9keWgDfSs#AS*'(Ec5](
@rri7ATW'6-ZF*@F)?&4E-ZP:E\]@E67sa,Eb]Z4F_>Z=FCfJ8F"JsdF(KH9E$04=F_>Z=FCfJ8
E,ol3ARfg7%13OO@rGk"EcP`/F<Dr?@<6!-%17#a+?MV3F)?&4E-ZP:EZfLHBl%i<+BosE+E(d5
-RT?1C2[Wq?YO7nA7%J\+=C*)F_=NrFCfJ?%15is/g+tK@:UL'F(Js+C`mkBBl%i5Bl8$2+=Lr=
De(:+$;No?+=Cl<De(4<B4Z0-I4cXTEc<-KB6%s$CghC+F`_>6F!hD(:-pQU-Y[=6A1&L4ATT&C
/g+eIE$-N=@V'e+-OgDX67sB.BkhQs-Qm&5F<Gua+D5_6+=C]2GA(]4ASQ9rEbTK7-OgD1BkhQs
-Qm&5F<DrQF!hD(-Y[=6A1&L4ATT%BE,oZ1FE;/BASYk&?XdGbBk)6rF*(r$FC?O>+:SZQ67sC%
ATT&9D09fCFCfJ8F`V,7+DYP6Et&ItD/XQ=E-67F-ZsKAE_BthF!,L7F(KG@%14M*Db*Z&<$47F
HTE9#+>G!XBk(p$1a$FBF<DrPD09K1H$!V<<HD_l94`Bi-Rg0^EbTW,+DPk(FD)dEIUd;6Anbm2
F`V,7CLqd4/n8L+-Qij*F)>i<FDuAE+=D5IF_>Z=FCfJ8E,ol3ARfg)F(KH9E$-NLD09K1H$!V<
<HD_l94`Bi1,Vfn/g,:XATDQtH#kTJAnMP[:-pQB$;No?+B)i_+EqO8BcqA'B4W30GBYZSF)PZ4
G@>N'/n8g:05>]FCM>FlF_PAtF"]n!DJ!Tq01o)`03*()E_BthEt&IO67sBhCiaMU+D>k=E&oX*
C3+<*FE_/6AM.J2D(fO9FDPZ4F>%WUBk1d-B5)H@@Vfsl05Y-=FCfJGCh[?3@UX=h06M>IEbf63
F"UsAE"*.L67r]S:-pQU7<i6XE,9*,3XlEk67sB'7Pd+\4&'F,ATN',AT24$4)AhDA0<7K@:Wne
DK@ID@;TRs05YE@ATN',AT24$06LuQA1hS2F!hD(:-pQU+@C6kCb&%<0KVd@Df]u.Ed9`UEc6/C
ARB1Z-YRUDE&oX*GB\6`C3+<*FE_/6AM.J2D(fXJBkqE9<c;JV@WcKqEd9<.Ci=B9@<-W@%15is
/e&._67sB)6Zd?b.n2E@%15is/g)?*FE21J;eTlWF=Tg=+q4lS67sB);eTlWF=Tg=+q4lS67sB)
7Q2M#$;No?+<j0pEbm6q2^/\<:-pQU,"$HmCb&FtBkDH;7Q2M#$;No?+<j`tBkDH;7Q2M#$4R>3
1-73P;Is]RCLnVUF`MM6DKIsVB7:t<De*K'>9IElARTU%-RT?16Zd?b.n29U0fr<FF<EqnEcP`/
F?=Ma+=D,KC3+67B5i-<ATB.@>9Iip+=D5IF_>Z=FCfJ?+BosE+E(d5-RT?16Zd?b.oU+qAooOm
1-73P7!3?c+Ad3&4*#Bb-Y.@:E,]rA-OgDP1HR<Q;IsijBl[c-8l%i:Eb065Bl[c--YI".ATD3q
05>E9-OgDMFE21J7Pd+\4&TX"H"1Z%+A,Et4"+i^A8c?./0J\GA8c'l.3L>S$<(VPAooOm1HR<Q
8l%ht87cUV4)/\EBOu"!+>=637Pm1\4%*XhF_;gpF`'9O@WHU/+=ANG$:Zp80fr?GF*&O'D/X3$
4'cfGBl8$6BmO?+AU,D;EbTE5F(or3CLqcu@UX=l@ru:'FC\g%@1<QBBPD(#.n2EY0fr?GF*&Nk
@<6-m4#%juFEAWQE,oZ1FE;/BASYk&?XdGbBk&hN-N                                ~>
)
showpass 4 put ". ".'zz_',SOLOCALE,'_' [ cocurrent 'base' NB.{*JOD*}
".soclear NB.{*JOD*}

cocurrent SO__JODobj NB.{*JOD*}
zz=:''
zz=:zz,'(<<;._1 '' MirrorXref AlbumPathTable BackUpMirrorXrefDb BuildMirror '
zz=:zz,'CR CreateMirrorXrefDb CreateMirror_sql DumpLocalImageNatural IFACEW'
zz=:zz,'ORDSMirrorXref LF LOCOMISS LOCOXREF LoadAlbum LoadImageAlbumXr Load'
zz=:zz,'ImageKeywordXr LoadLocalPath LoadMirrorXrefDb LoadOnlineImage LoadO'
zz=:zz,'nlineKeyword LocalFile_sql LocalFrOnline LocalOnlineFile_sql MACROS'
zz=:zz,'MirrorXref MANLOCOXREF MIRRORDB MIRRORHEAD MatchManual MatchOnlineL'
zz=:zz,'ocal MatchOnlineNoBrackets MirrorImageXrTables MissingImagesReport '
zz=:zz,'MissingLocalFiles_sql ROOTWORDSMirrorXref RealDateFrManifest Update'
zz=:zz,'LocalPresent UpdateLocalPresent_sql afterlaststr afterstr alltrim a'
zz=:zz,'llwhitetrim assert b36casemask b36fd beforelaststr beforestr boxope'
zz=:zz,'n changestr charsub ctl fboxname ferase fexist insqltd justfile ofr'
zz=:zz,'eq portchars quote read readtd2 reb smoutput toCRLF toHOST toJ tolo'
zz=:zz,'wer tslash2 write writetd2 yyyymondd''),(<<;._1 '' SmugPyter MirrorIm'
zz=:zz,'ageXrefTables MirrorImages MirrorKeywords MirrorMD5s NOPIXELSKEY NO'
zz=:zz,'RATIOKEY SMUGAREAROUND SMUGASPECTROUND SMUGPRINTDPI SMUGPRINTSIZES '
zz=:zz,'SMUGPYTERSIZES allwhitetrim assert charsub degeotag dpiarearatio ge'
zz=:zz,'otag lastones ofreq printsizekey printsizestable readtd2 rekeyword '
zz=:zz,'round sortprintsizes tlf tslash2''),(<<;._1 '' debrii DEBRIIBAT DEBRI'
zz=:zz,'IEXT charsub ctl dblquote debrii justext toCRLF toHOST toJ tolower '
zz=:zz,'write''),<<;._1 '' smugpyter SMUGAREAROUND SMUGASPECTROUND SMUGPRINTD'
zz=:zz,'PI SMUGPRINTSIZES assert charsub printsizestable round smugprintsiz'
zz=:zz,'es''                                                                '
zz=:1410{.zz
showpass 2 grp&> ". ". 'zz_',SOLOCALE,'_' [ cocurrent 'base' NB.{*JOD*}
".soclear NB.{*JOD*}

cocurrent SO__JODobj NB.{*JOD*}
zz=:dec85__MK__JODobj 0 : 0
0eje*+>P&o0H`2,2`ONGEcQ)==E7tb%15is/h0S0EcQ)==E7tb+EK+d+CfG'@<?''@;]TuCi<`m
+EMO=Blmo/D/"$2DfQt1Ec6#?+ED%*ATD@"@q?cn@<>pe@<6!4%15is/e&._67sC(ATD6gFD5SQ
%15is/e&._67sBpDKKH1Amo1\+EqaEA12LJ3Znk=:-pQU/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+
/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/(f+<VdL
+<VdL+<VdL+<VdL+<VdL+<VdL+<VdL+<Vd9$;No?+<X!nBl%<SBl\64EZcqV@UWb^F`9!DEb/[$
AM7k<@:UKtBl\64EX`@N67r]S:-pQU@rc-hFCeuD+>PW*3,3SR0K'@I:-pQU/M/P+/M/P+/M/P+
/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+/M/P+
/M/P+/M/(S$;No?+>GijF`&lk+D5_5F`8I5CghC++CfG'@<?'k%15is/g)l.C3=DL1E^OCBl5%A
6?R!YA5-cYEc5tI+CSekARl5W:-pQU0fWojDDF*mF(8lpD.+Q!Bl7?qBmO?$+CT.u+=KX#D/`0e
@ps1FD..'g:186eEa`c5+CSekARl5W:-pQU0fWojCb[Ud-r"DsF(oN)9Q+ELCdr,TATM4"EGR'H
@:Wn[A.8l@67sB83,3SP0esk"9jr-RBMWM^Bl7KWDaJJQ@r#XtF"&5?A7T7^%15is/g)l.C3=>I
2]sMCBle?0DJ)OX@:s.m;IsfcEc``Q@:Wn[A.8l@67sB83+QT10JO[u:gnBUDKJ?dCh.*tF"AG*
D..'gF%g"`FB*9j@<?'k/0I`+Ch[cu8SqmKAOCBYDKIEP=(Pi@EbQsF@:Wn[A0>u4+=KNl@WcN:
+EV%$Ch4%_%17,eEHPu9AKW@2@<>p2F)c#1FCcg/$4R>PDe!TlF)rHO9keWgDfSs#AS*;4%13OO
:-pQ_A7]^kDId<rFE7lu:-pQU-n6Z/3Zpe1ART[l9keWgDfT3+EGQakDe!3l7VQ[M?ZU4'+B<Ak
@<?'SDe!3l:i^,gASuTsF)c"=9Q+ELCenqbBl7KOBl%?fF)c"*$;No?+=J]g4ZX][Ble?0DJ)X]
@ps1CBl%@%?ZU4'%15is/h1FMA7T7jASu$iDKKq/$4R>;67sC%@q]Fj@3BK#+Dkh5Ec5tNA7?Zl
@<>pe@<6!&/Kf"@EcYf&+E)-?-T`[u@q]:k@:OCjEX`@CEb/[$APHlZEc5u*F)c"Z3Zoh)+?CW!
.1HVoEb/[$AKZ)'@VfTu9Q+ELCf"P^BFP:k+=Kp%@ps1M@<?0S6m-2]FCf)rEZf7<F<GIDCht55
EbTB!Ed8dCAU,g9$6UH69Q+ELCf"P^BHVD.G]Y'GDfd+>F_kkC3t2N+$=e*f@<?''FCAWpAKXcd
Ch[cu94`BmDfT@t$6UH>94`BmDfTA2FCf]=+Du+>+Du=<C`m\;Bl.:!Gp$m6Gq9C3+<Ve"AU-ac
AT;j(DI[r7Bl8$(B4Z*+DJsV>DKTc3.6@tG+<Vd9$=e*f@<?''FCAWpAKX9T@WcMs$6UH>6#:"Q
D+eGc+EV1>F<GI>F<GIDCht55EbTB!Ed8dCAU,g9$6UH69Q+ELCf"P^BLtT7Bl8$(B4Z*+DJsV>
DKTc3/.Dq/+<X?r@ps1MEb0<'DKI"8DKKH&ATAo'BOt[h-qnPh@;Jb\ATMF#F?Mc@+E)9C9Q+EL
Cf#.`F(K624ZtMK/.Dq/+<XHtCh[cu8SqmKAOCBYDKI"8DKKH&ATB=2$6UH69OW!a<H)JWFCeu*
A79Rk/.Dq/+<X6m@:s.m9OW!a<H)JWFCeu*A79Rk/.Dq/+<Wsd@WcN_@;TQuFCf]=/.Dq/+<XKh
Eb0-17W3*RATDi7FCf]=/.Dq/+<X`s@T@G_+EV1>F=[k.+<VdmCgqO(6tLFLEbTK7Bl@l3FCf]=
/.Dq/+<Y97Eb/rtDBN_+Gpl@)@ps1M@<?0S6n'7!AS,LoASu!hF!+.p@ps1b:gnHZ-qnPh@;JbK
FD+66.4I=f$4R>PEb/[$AKZ)'@VfTu:Msu_DIlCV@:s-\$6UH>8SqmKAP6T[+EV1>F<GI>F<GID
Cht55EbTB!Ed8dCAU,g9$6UH6:Msu_DIlCV@:s.@Bl%?'FCf]=/.Dq/+<Wsj@q]S"ARnM'2'@!P
G]YJG$6UH66#pIKBm+&u;e^Ph+DG_8AS5Rp/.Dq/+<X?dFD5i>A7ZlqCi<a(/.Dq/+<X?rDJ*[*
F_#&+Ao)BoF=[k.+<VdmCijB5F_#&+Bl8$(B4Z*7%144#+A[#lB5)6lCe/,OB4uB0Bl8$(B4Z*7
%144#+A[#lB5)6lCfb=]FD)e2DKKH&ATB=2$6UH6;Is9Q6t(1K+Cno&ALn8t+<Ve,E,9H$A40jJ
AKYMlFCd!4$6UH69OW!a<H)JWFCeu*A79Rk/.Dq/+<X[)BcqM/G]YJG$6UH6<+pDk@W#UgCfPLl
+EV1>F=[k.+<Ve"AU/K<Eb'56FCf]=/.Dq/+<X$[E-,f4DBO%4G]YAr%13OO@rc-hFCcS:@:F%a
+A$EYB4XAF@WcNiEX`?u+=Kfu@:s.EAU,D?AU&;>DJsV>DKTc3/.Dq/+<Wsd@WcN\AU,D?AU&;>
DJsV>DKTc3/0GB/+<VeGEbTB!Ed8dCAU,[qD..'g94`B"+@0gQF_sc_Gpt9R$6UH6AoD^$BkM<+
CLqc>6#:"QD+eGc.3NYBAn?!oDI[7!+@0gQF_rNmCgqO(94`At/.Dq/+<Y97Eb/rtDBN_+Gpl7$
@:s.EAU,^IEb/ioEb0,uATJtiDJX$)AP$`IB4WJ_D..'g94`At.6@tG%16TcART[l+EV%$Ch4_\
D..'g94`BmDfTAjEX`?u+=Kfu@:s.EAU,D?AU&;>DJsV>DKTc3/.Dq/+<X<gH$=1IA0>u*G]Y'G
Dfd+>F_kkF%144#+E2@8D..I1+DYP6-qS8aB4X_IGq:(2AU/K<Eb$UM%144#+D,P4ASGdp+DYP6
-qe,sGAhM4.3NYBAn?!oDI[7!+AZlkBl7KTAU/K<Eb$RkAU/K<Eb$UM%144#+D,P4ASGdp+DYP6
-qS8aB4X_IGpskVAS,LoASu!hF!+7rCh[cu8SqmKALL,e@:s.EAU,^R3t2N+$=e*f@<?''FCAWp
AKXZb@ps1FD..'g%144#-qnPh@;JMP@:s.C6m-2]FCf)rEZf7<F<GIDCht55EbTB!Ed8dCAU,D,
F`_P9DI[]uD.RU,/.Dq/+<X?r@ps1QBQ\0$8OO\8DKKH&ATAo2Dfd+>F_kkF%144#+A?]`@;JbK
FD+66+DG_8AS5Rp+Du+>+Du=<Cb-#&+<Ve#De!3l8SqmKAO^BMAKZ)+G]Y'GDfd+>F_kkF%144#
+A$EYB4X_IGp%3?G]Y'GDfd+>F_kkF%144#+D,P4ASGdp+DYP6-qnPh@;JbKFD+66.3NYBAn?!o
DI[7!+A?]`@;KLO@<?029Q+ELCf"P^BLtT@/.Dq/+<Y97Eb/rtDBN_+Gpl7$@:s.EAU,^IEb/io
Eb0,uATJtiDJX$)AP$`IB4WJ_D..'g94`At.6@tG.1HUn$;No?+AP^3762Q5BOr<$+EMO=Blmo/
@:WneDBNY7+D,b;F*Sm:@W-C2+D>\;+EMO=+DGm>AoD^,@<?U&A1e;u:-pQU;KZkpBl7Q+F*(i.
A79Lh+EMO=+E2@4FEDdNE,oZ1FCfK6+E)9CBl7HmDKKT1B-;88C`mG0+F.mJEX`@N67sBm@<QR0
Blmo/F*)\DAKY].+Dbb-AScW7FDi:@Ec5K2@q?cmDe*E%FD,*)+CoD%F)E@I+EqaECG$&':-pQU
<+U,m+F.mJEZfFCC`m>1@:sFgDKKqBFDi:1G&M)*+EV:2F!)ZKBk(piH"(]1+X.@&9Q+ELCdr,T
ARBLuCcsg%-nlc)+>>5R$?KcpARfg)+CQloD..'g94`B"+AZlkBl7KRD..'g7VQ[M/0IW)@ps1M
@<?0*Ao_g,+AZlkBl7KRD..'g+CP]dBl7g"EZf+8Bl5%bD..'g6#:"QD-1g$@N]T,+CQloD..'g
94`Ak4Wn2d8SqmKAP6T[%16feDImi2C2[g(+@0gQF_r72+E)-?@kL&`@WcN\AU,C]+CZrhCgqO(
94`AX$>FBqATAo.DeX)39Q+ELCf"P^BHUh.Df-\./kg1n@;JbKFD+66+?^iW/kg1n@;JbKFD+66
+:S[%BOu3q+Cd#iCgqO(94`Ak4Wlru$?'rqATAo&Gp#n#Ch[cu8SqmKAO^BMAIStq%13OO<H)JW
FCe-a@ps1MEb0<'DKK6,EGRd!+=D;NA79Rk+@0gQF_r7BATT%gDe!3l:i^,gASuT44WlI%GA(Q.
AKX9T@WcN\AU,D4DBL;9$4R>9De!3l:Msu_DIl:OCh6spEGRd!+=Jod3Zp+*%17/fCh7*u+AucZ
Cd_]RALns6/kKngB4X_IGq:(3De!3l<+pDk@S&s=+CZrsDe!3l:gnHZ8OP*P9Q+ELCf"P^BIk9"
De!3l8SqmKAO^BMALns"DJX$)AP$`IB4XPHCh4`$Ec5e;9Q+ELCe8JPB4W2o+:SZlDJj$++DPh/
DBMVk@ps1M@<?0*@N]T,+CZrsDe!3l:gnHZ8OO[a+CQlrDe!3l:gnHZ8OO[1$>FBqATAo.DeX)3
:Msu_DIlCV@:s-o@j#]-+Cd#qD..'g94`Ak4Wn/c8SqmKAP6T[+:SZrEb&a%+C]U=;Is9Q6t(1K
%14Nn$4R>:Ble?0DJ)X]@ps1CBl%@%?ZU4'4ZX]60H`D!0I[G<F(K0!@rri'Dfor>-o!.n@<3Pc
Ble?0DJ)=SF=\PE/jX;_F_sl^D.P7@B6%p5E*m*nDI[*s-r4_sBl7KRD..'g7VQ[M/0H<f-Rg0H
F!+4r9Q+ELCdr,TAKYT*Df$UmDJX$)AP$`IB4W2o%16feDImi2C2[g(+A$EYB4XAF@WcNiEZeg6
Df-\,/kKngB4X_IGp#6m@4k,g@:s.EAU+^lBl7g"EZf+8Bl5%ZCgqO(+CcO4DBNFA6#:"QD+eGc
+?^iV/jX;_F_sc_Gmt+)BOu3q+CQloD..'g94`AkDJsV>Bl5%AF(K0!@rrhbD..'g94`AkAo_g,
+A?]`@;JMP@:s.#%16`gDfp"A@X0)+/jX;_F_sl^D.O.`DfTB"EZeh:+AHQkF(oN)6Z-ug@<5of
$7P                                                                       ~>
)
showpass 2 put ". ".'zz_',SOLOCALE,'_' [ cocurrent 'base' NB.{*JOD*}
".soclear NB.{*JOD*}

cocurrent SO__JODobj NB.{*JOD*}
zz=:dec85__MK__JODobj 0 : 0
3?U%!1*A;*+>biJBl\64E`d?nAn,jm@<?''@;]TuCi<`m+EMO=Blmo/D/"$2DfU)CAS*&q@<>pe
@<5u                                                                      ~>
)
showpass 2 8 put ". ".'zz_',SOLOCALE,'_' [ cocurrent 'base' NB.{*JOD*}
".soclear NB.{*JOD*}

cocurrent SO__JODobj NB.{*JOD*}
zz=:fromascii85__MK__JODobj 0 : 0
1E\P#-p0UR/mg=U-Qk]k@WcNa@<?0^@:F%a+@0gQF_t6$AS*&O@:O(QE(t%eEc5u#Eb/iN@N\![
Bl%<SBl\64EZd_J;dVn1Ci=?8+@C0\@<?'TBl\64E`d?nAjg)N6ZQaHFCe0\EcQ)=?ZU4'+@JXb
;FsGH5u\sp77'mD8OZ`\+@L-bBl7?sF@0t_DfSZdGT]CsD/`0e@ps1FD..'g:186eEa`c,7<ioV
Eb/i*8Oc!579<8_6rQfoEcQ)==E7tb+A>Qu:JFDZ;]nb06Vgf^77JCnDdd0BCgqO(+A?]^A4^WH
B4XAF@WcNiEZe%o@:VrH@:s.EAU/K<Eb&9m+A?]^A5$oO@;JbKFD)djDdd0NBl\64E`d?nAjg)N
9Q+?M:Msu_DIlCV@:s-o9Q+?M:Msu_DIlIPH$=1IA0=Qa@ps1CBl%?fF)c"=9Q+ELCdrG@DJX$)
AKXZb@ps1LDJX$)AO^BMARBLuC`lG<6W-]Y9keWgDfSs#AS*&Z5u(*L6Vgf^77JCo8Q&G^;FEho
9hA5\:Js_P5suhi@<?!m9jqp^@;I&\@<?!m:Msu_DIlL[@ps0r9jr-RBMWM^Bl7KWDaJJQ@r#Xt
F!+1kEcQ)=8SqmKAQ3)ICh4_`Bl\64E_1+VB4Y1c<+06PATJtgBl\64E_1+VB4Y1cAS+nM@VfUs
+AHQjEc5tiD..'gF!+1kEcQ)=94`BmDfTB0+AHQjEc5tm6o?)]Bl\64E_SqZF!+1kEcQ)==E7tb
+AHQkF(oN)8SqmKATLa\E,Tc=+AHQkF(oN)9Q+ELCdr,TATM4"EGQam:JaVb78-WQ79La.:JsJX
8P_uJ=WgOLFD+csAS*&_:JXqk:JsSZ9keWgDfSs#AS*&_ARTCC@<?'ME_Tt[BkCptF<FLV<C]>Q
76sgI<DGq);b^7^5uUTK6W?rZ<DGq);b^7^:f9k[<('PS+B)!77o3)T:/k.`>")@4;b^7^:g$ad
;H$.j78k=-<_$LaDes?4F!+J%A79Rk9Q+ELCf#.`F(K62+B<Ak@<?'SDe!3l:i^,gASuTsF)c"=
<c;esD.QgiAS*&d77(?XGscLdDfTnA@P]oP@<6!s@<63,@rH1%Ebf63Ao_I&+CfG'@<?'TBl\64
E`d?nAjg)N@rc-hFCe0\EcQ)==E7tb<+06PATJu)AR][oBcpqtB4Z"'@:p]nE+ra$ARTUfFD5Y9
Ao2X*AU/>>B4Z"'@:p]sD..'g;e'KPD.-dmEGQb3DKBf6FCZM4Ao_I&+E2@8DKKr6H=^l'Gp%'H
Bl8$6BmO?+AU.Wl@<6-mFCfN8A79Rg+E2@8DKKr6H=_/>@:F%a+ED%/AU/K<Eb$;6BmO?+AU,D>
D09K1EbTE5F(or3F!,OBEcc8@Bl8$6BmO?3-RgSp4?P\X?SNZN+C]J-Ch.BsEcQ)=+E2@8DKKr6
H=^l'H!b#hF(o,<0IJ;#-p0UR/mg=U-Ql,tEcQ)==E7tb+B*-"B2EkqATAo(AR][oBcqJ6F_>Z=
FCfJ?.4cl00I/>$/1<VC4"akp+=A9tA867.F@:%aBl7?sF@0t_DfTo+FEhmM6ZQaHFCe0\EcQ)=
?ZU4'+Abj4<*r@6EcQ)==E7tb+C\c#AMZ5OE-WRCBl\64E`I0lE_BthF!,FBC2I[*Ec5t@E,o]7
D09K1H$!V<+EMCBB5i-<ATCdlATCFTH#k>^/1<V9+?)2(1,(FB0ekFD/i5IF1cI9N1GL"-0JPO@
1,(L:1c-mC0K;$J+>PW*3&!6G1bL[@1c@$G0JPR11,(FB0K([B/iGUF1c@0I2`W!90JPO@1GCa?
2Dm6F3B&WP1a"P-0fUjF0fL^C2D[0D3AiTQ+>PW*3&!6F2_I!G1,:dI0fV*71,(FB0K:dB/i>XG
2`WZO0fL410JPO@3&*0@2*!KP3AWNI2]sk00fUjC0fL^D3B/lO3&EKQ+>PW*3&!6G2_I'D1H@BS
2)mB71,(FB0JY=</i5C=1b^mK1E\G,0fUjF0fL^C2)$a@2)@!D+>PW*3&!9H1G1UC1GgmG1G^g0
1,(FB0K([F/iYdL1,(^G1H?R50JPO@2DI-C2)$pI0fCmD2BXb/0fUjF0f^jG3A`WR1,1OD+>PW*
3&!6G0ePFC1H$pB2)7$31,(FB0K(XE/i5L@2E3BM1c-=10JPO@2DI-C2E3WN2`NcT2]sk00fUjF
0f^jG3A`HL3&<6K+>PW*3&!6F2_I!B2DQs?1GLU,1,(FB0K([A/iG[F1cI6M0esk,0JPO@2DR$?
2E3KH1cIEP+>PW*3&!6G2D-sJ1,1RA1c.!21,(FB0K([B/i>I@1,1O=0fL410JPO@2_d*@3&39K
3&iWQ2BXb/0fUjF1,ggF0Jb^J3A`EL+>PW*3&!6G1G1OF0K:aH3B&r@1,(FB0K1^H/iP^C3&NKJ
1G^./0JPO@2DR0C3&3?N1H%'I2]sk00fUjG0et@@0JPRA0f(RF+>PW*3&!6F3%d0H3&!?I2Dd03
1,(FB0K(XA/iYXA1,(CA1c?I30JPO@2D@!@3&3HP1,psE1E\G,0fUjA1GCF@1bh!E2)@*M+>PW*
3&!'C0J5=>0JG=D1GLj31,(FB0JP@;/iY^C2*!NK2)6:00JPO@0f(L93&NKP0JkRC1*A>+0fUjB
0Jb=<1b^a?3&i]:1,(FB0K1^F/iYdF0JG4<2)l^60JPO@2_d!=2`E]V0JG:>3$9t10fUjA0eb4=
2)@*M2E!HP+>PW*3&!'A0J5:A1H%3K0f_*61,(FB0JY=</i5C=1b^mK1E\G,0fUjF0fL^C2)$a@
2)@!D+>PW*3&!6F1G1XC0KD$J0JtR-1,(FB0K(XA/iP^J0ekI?1,9t-0JPO@2DI!?2`EZM0f([C
0d&5*0fUjA0Jb=?2D[*E0f_!E+>PW*3&!'@1G1UH3AWBK1,q$31,(FB0JP::/ibjN3AiNF3B83;
0JPO@1GCa?2Dm9H2E*TS+>PW*3&!6G1G1R>1H@9O2)$s31,(FB0K([B/iGUJ3AiZO1,9t-0JPO@
1,(L:1c-mC0K;$J+>PW*3&!-B2_I!G1c76O1bgs41,(FB0K([B/i>OI1cI9J1cZ[60JPO@1GLg@
2`NcR1G^gF3?U(20fUjF0K(OC0JY@=3&WNJ+>PW*3&!6E2D-sD0K(dE2Dd<71,(FB0K:dB/i>XG
3B&WN0K1+00JPO@1,(U=3A<BH1H@3K+>PW*3&!'@2(ggG2E<]U0JP:)1,(FB0JbC=/iPL@3AiTI
1cZ[60JPO@1,(U=3A<BH1H@3K+>PW*3&!6E2D-pK1cI*J1,h$41,(FB0K([?/iPXC3ArQO0JXb+
0JPO@2DR3D3&!-K2`W`T1E\G,0fUjA0eb4=2)?pD1H@3G+>PW*3&!'A0J5:C0ekLE1,^s31,(FB
0JP7</iP[H2`*KR1GL"-0JPO@1,(U=3A<BH1H@3K+>PW*3&!9H1G1UE1GCaJ3&ic<1,(FB0JP7;
/iP[K2)mEH3B&'90JPO@0ebF:2`<HH2E*HL0d&5*0fUmB1-$sD3&*-C2*!TO+>PW*3&!*A1G1L@
0JkIC3&;[40JPO@2_d<F2`EHG1cR0J3$9t10fUjG1,COA1c$sK2`Mp80JPO@1GCa?2Dm6F3B&WP
1a"P-0fUjF1,ggF0Jb^J3AicP+>PW*3&!6F2_I!G1,:dI0fV*71,(FB0K:dB/i>XG3AE6J3B83;
0JPO@3&*0@2`3<M1Gh!K2]sk00fUjC0fL^D3B/lO3&EKQ+>PW*3&!9H1G1UC1,UjA3&W]<1,(FB
0JY=</i5C=1b^mK1E\G,0fUjF1,CO@2E!NO1G_!F+>PW*3&!9H1G1UC1GgmG1G^g01,(FB0K([F
/iYdL1,(^G1H?R50JPOA1,(F83&!*C1-%3I1a"P-0fUjF1,CO@0eb=@2)@-51,(FB0K([F/iYO@
3B&rU3&;[40JPO@2DR3D3&!-K2`W`T1E\G,0fUjG0f^jF2`*6C2DQsD+>PW*3&!6G1G1R?0JPLD
3A<941,(FB0K([F/iYO@3B&rU3&;[40JPO@2DR'@2).*K1,V$M3$9t10fUjF1,U[D1GLgJ3&`NJ
+>PW*3&!6G2D-sJ1H.*J3B&o?1,(FB0K([B/i>I@1,1O=0fL410JPO@2_d*@3&39K3&iWQ2BXb/
0fUjF1,ggF0Jb^J3A`EL+>PW*3&!6G1G1OF0K:aH3B&r@1,(FB0K1^H/iPdL0eb=:3AM^40JPO@
2_d'?3&<KN0ebI?1*A>+0fUjG0et@@1Gh'M2E3BK+>PW*3&!6F3A*9M0JtgH2DI061,(FB0K1^F
/iY^J1Gh'G1Gp:10JPO@2D@$A2`NcS2E<]P1a"P-0fUjA1GCF@1cI9K0Jb[D+>PW*3&!6F2_I!B
2E3TP0f(d31,(FB0JP@;/iY^C2*!NK2)6:00JPO@0f(L93&NKP0JkRC1*A>+0fUjB0Jb=<1b^a?
3&i]:1,(FB0K1^H/iP^D0f1dH1G^./0JPO@2_d!=2`E]V0JG:>3$9t10fUjA0eb4=2)@*M2E!HP
+>PW*3&!'A0J5:A1H%3K0f_*61,(FB0JY=</i5C=1b^mK1E\G,0fUjG0et@@2)R3I1H.'J+>PW*
3&!6G1G1R?0JPLE1,^m11,(FB0K(XA/iP^J0ekI?1,9t-0JPO@2DI!?2`EZM0f([C0d&5*0fUjA
0Jb=?2D[*E0f_!E+>PW*3&!'@1bL^F1c7*L1c%$41,(FB0JbC=/iPI>0fCdF2_lL20JPO@1GCa?
2Dm9H2E*TS+>PW*3&!6G2_I'D1H@BS2)mB71,(FB0K([D/iY[E2)[-J1GU(.0JPO@1,(L:1c-mC
0K;$J+>PW*3&!-B2_I!G1c76O1bgs41,(FB0K([D/iY^C1cR3M1,9t-0JPO@1GLjA0JbLA1,CpG
1E\G,0fUjF0fL^C2DR9O1c$jF+>PW*3&!6E2D-sD0K(dE2Dd<71,(FB0K:dB/i>XG3B&WN0K1+0
0JPO@1,(U=3ANKJ2)@$D1E\G,0fUjA0JtIA2`E]R2)-dC+>PW*3&!-B1G1U@1cRHM1,0n,0JPO@
1,(U=3AENO0JbUH0d&5*0fUjF0K(OC0ekXE1H%*K+>PW*3&!6G2_I'D1H@BS2)mB71,(FB0K([F
/iYO@3B&rU3&;[40JPO@0ekL;2D[9H2)-jE+>PW*3&!'A0J5:C0ekLE1,^s31,(FB0JP:=/iGL>
2)?sA0d&5*0fUjB0K(OD0K1^B3ANK81,(FB0K1aC/iP[E0K2!O3&Mg60JPO@0ebI;2`NTO2_m'F
0d&5*0fUjA0JkC@2D['G2`*?G.4cl01*A=t1,(FB0K1^A/iY^B0JbC;3&Da50JPO@0ek@72`E`O
1c.0N1*A>+0fUjG0et@@2)$^?0JPOD+>PW*3&!'A1bL[H1H@3L3&i?<-p07-1aFh10fUjB0Jb=<
1bg[?1c7371,(FB0JP:</i5C?1H@-F+>PW*3&!<H1+kFE2*!?G0fV'61,(FB0JP7;/iP^G0JbLE
1bg+.0JPOA1,(F82E3ZS1H.!E3$9t10fUjF0JtIB1,q6O1c.!E+>PW*3&!<H1+kFE2D@*E2_m?8
1,(FB0K([?/iPXE1H%*M2E<3;-p01/0I\P$4>J$=,Vh&.3&!-C2_I*L1H@3E0ebC+1,(FB0K(XA
/iYOF0Jb^E2)cX50JPO@2DI-C2Dm0C1H%!I1E\G,0fUjF1,CO?1,q-N1H@3J+>PW*3&!6G0ePCC
1GggH2Dd341,(FB0K([@/iP[G0ebFA2_uR30JPO@0ekI:1c$sC1c-mB3?U(20fUjA0f(F=2)-pE
1-%-M+>PW*3&!-C2_I*L1H@3E0ebC+1,(FB0K([F/iYO@3B&rW2E;m80JPO@2DR3D3&!-K2`WfT
3?U(20fUjF1,CO?1H@<M1bgd/1,(FB0K1^H/iYO?2DI3N3AVd50JPO@2_d<F3&!3E1,(I@2BXb/
0fUjF1,1C?2)m?K0ebC+1,(FB0JP:</i5FE0JkUC2)Zm7-p014/1<V7.4cl00I\P$4>8384>6 ~>
)
cocurrent 'base'  NB.{*JOD*}
puttstamps_ijod_=: (((1;'upgrade JOD')"_)`putallts__MK__JODobj)@.(3 = (4!:0)<'putallts__MK__JODobj') NB.{*JOD*}
showpass puttstamps ".".'zz_',SOLOCALE,'_' [ cocurrent 'base'  NB.{*JOD*}
".soclear NB.{*JOD*}


cocurrent 'base' NB.{*JOD*}
0 0$(4!:55);:'sonl_z_ SOLOCALE_z_ soput_z_ soclear_z_' NB.{*JOD*}
showpass 'NB. end-of-JOD-dump-file regenerate cross references with:  0 globs&> }. revo '''' ' NB.{*JOD*}
